<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module 00 — Networking & 802.11 Foundations | WiFi Exploitation Course</title>
  <style>
    /* ── Reset & Base ─────────────────────────────────────────── */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:        #0d1117;
      --bg-card:   #161b22;
      --bg-code:   #0d1117;
      --border:    #30363d;
      --accent:    #58a6ff;
      --accent2:   #3fb950;
      --accent3:   #f78166;
      --warn:      #d29922;
      --text:      #c9d1d9;
      --text-dim:  #8b949e;
      --text-head: #e6edf3;
      --radius:    8px;
      --font-mono: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
      --font-body: 'Segoe UI', system-ui, sans-serif;
    }

    html { scroll-behavior: smooth; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      line-height: 1.7;
      font-size: 15px;
    }

    /* ── Layout ───────────────────────────────────────────────── */
    .page-wrapper {
      display: flex;
      min-height: 100vh;
    }

    aside.sidebar {
      width: 260px;
      min-width: 260px;
      background: var(--bg-card);
      border-right: 1px solid var(--border);
      padding: 24px 0;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    main {
      flex: 1;
      padding: 48px 64px;
      max-width: 900px;
    }

    /* ── Sidebar ──────────────────────────────────────────────── */
    .sidebar-logo {
      padding: 0 20px 24px;
      border-bottom: 1px solid var(--border);
    }

    .sidebar-logo .course-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: var(--text-dim);
      margin-bottom: 6px;
    }

    .sidebar-logo h2 {
      font-size: 14px;
      color: var(--accent);
      font-weight: 600;
    }

    .sidebar-nav { padding: 16px 0; }

    .sidebar-section-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: var(--text-dim);
      padding: 12px 20px 6px;
    }

    .sidebar-nav a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 7px 20px;
      color: var(--text-dim);
      text-decoration: none;
      font-size: 13px;
      transition: all 0.15s;
      border-left: 2px solid transparent;
    }

    .sidebar-nav a:hover { color: var(--text); background: rgba(88,166,255,0.05); }
    .sidebar-nav a.active { color: var(--accent); border-left-color: var(--accent); background: rgba(88,166,255,0.08); }
    .sidebar-nav a .mod-num {
      font-size: 10px;
      background: var(--border);
      border-radius: 4px;
      padding: 2px 6px;
      font-family: var(--font-mono);
      min-width: 28px;
      text-align: center;
    }
    .sidebar-nav a.active .mod-num { background: rgba(88,166,255,0.2); color: var(--accent); }

    /* ── Header ───────────────────────────────────────────────── */
    .module-header {
      margin-bottom: 40px;
    }

    .breadcrumb {
      font-size: 12px;
      color: var(--text-dim);
      margin-bottom: 12px;
    }
    .breadcrumb a { color: var(--accent); text-decoration: none; }
    .breadcrumb a:hover { text-decoration: underline; }

    .module-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(63,185,80,0.12);
      border: 1px solid rgba(63,185,80,0.3);
      border-radius: 20px;
      padding: 4px 14px;
      font-size: 12px;
      color: var(--accent2);
      margin-bottom: 16px;
    }

    .module-header h1 {
      font-size: 2.2rem;
      color: var(--text-head);
      line-height: 1.2;
      margin-bottom: 12px;
    }

    .module-header .subtitle {
      font-size: 16px;
      color: var(--text-dim);
      max-width: 640px;
    }

    .meta-row {
      display: flex;
      gap: 24px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .meta-pill {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: var(--text-dim);
    }

    .meta-pill .dot {
      width: 8px; height: 8px;
      border-radius: 50%;
    }

    /* ── Legal Warning ────────────────────────────────────────── */
    .warning-box {
      background: rgba(210,153,34,0.08);
      border: 1px solid rgba(210,153,34,0.4);
      border-radius: var(--radius);
      padding: 16px 20px;
      margin-bottom: 36px;
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    .warning-box .icon { font-size: 18px; flex-shrink: 0; margin-top: 2px; }
    .warning-box p { font-size: 13px; color: var(--warn); line-height: 1.6; }
    .warning-box strong { color: #e3b341; }

    /* ── Sections ─────────────────────────────────────────────── */
    section { margin-bottom: 48px; }

    section h2 {
      font-size: 1.35rem;
      color: var(--text-head);
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    section h2 .section-num {
      font-size: 12px;
      color: var(--accent);
      font-family: var(--font-mono);
      background: rgba(88,166,255,0.1);
      border-radius: 4px;
      padding: 2px 8px;
    }

    section h3 {
      font-size: 1.05rem;
      color: var(--text-head);
      margin: 24px 0 10px;
    }

    p { margin-bottom: 12px; }

    /* ── Cards ────────────────────────────────────────────────── */
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 16px;
      margin: 20px 0;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 18px;
      transition: border-color 0.2s;
    }

    .card:hover { border-color: var(--accent); }

    .card .card-icon { font-size: 24px; margin-bottom: 10px; }
    .card .card-title { font-size: 13px; font-weight: 600; color: var(--text-head); margin-bottom: 6px; }
    .card .card-desc { font-size: 12px; color: var(--text-dim); line-height: 1.5; }

    /* ── Tables ───────────────────────────────────────────────── */
    .table-wrap { overflow-x: auto; margin: 20px 0; border-radius: var(--radius); border: 1px solid var(--border); }

    table { width: 100%; border-collapse: collapse; font-size: 13px; }
    thead tr { background: rgba(88,166,255,0.06); }
    th { padding: 10px 14px; text-align: left; color: var(--accent); font-weight: 600; font-size: 11px; text-transform: uppercase; letter-spacing: 0.8px; border-bottom: 1px solid var(--border); }
    td { padding: 10px 14px; border-bottom: 1px solid rgba(48,54,61,0.6); vertical-align: top; }
    tr:last-child td { border-bottom: none; }
    tr:hover td { background: rgba(88,166,255,0.03); }
    .tag-broken { color: var(--accent3); font-weight: 600; }
    .tag-warn { color: var(--warn); }
    .tag-ok { color: var(--accent2); }

    /* ── Code & Terminal ──────────────────────────────────────── */
    code {
      font-family: var(--font-mono);
      font-size: 12px;
      background: rgba(110,118,129,0.15);
      padding: 2px 6px;
      border-radius: 4px;
      color: #79c0ff;
    }

    pre {
      background: var(--bg-code);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      overflow-x: auto;
      font-family: var(--font-mono);
      font-size: 12px;
      line-height: 1.7;
      margin: 16px 0;
      color: var(--text);
    }

    pre .kw  { color: #ff7b72; }
    pre .str { color: #a5d6ff; }
    pre .cmt { color: var(--text-dim); font-style: italic; }
    pre .num { color: #79c0ff; }
    pre .hdr { color: var(--accent2); font-weight: bold; }
    pre .sep { color: var(--border); }

    /* ── Diagram boxes ────────────────────────────────────────── */
    .diagram-box {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      margin: 24px 0;
    }

    .diagram-box .diagram-title {
      background: rgba(88,166,255,0.06);
      border-bottom: 1px solid var(--border);
      padding: 10px 16px;
      font-size: 12px;
      color: var(--text-dim);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .diagram-box pre {
      border: none;
      border-radius: 0;
      margin: 0;
      padding: 20px;
    }

    .diagram-placeholder {
      background: var(--bg-card);
      border: 1px dashed var(--border);
      border-radius: var(--radius);
      padding: 32px;
      text-align: center;
      margin: 20px 0;
      color: var(--text-dim);
      font-size: 13px;
    }

    .diagram-placeholder img { max-width: 100%; opacity: 0.6; }
    .diagram-placeholder p { margin-top: 8px; font-style: italic; }

    /* ── OSI Visual ───────────────────────────────────────────── */
    .osi-stack {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin: 20px 0;
    }

    .osi-layer {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      border-radius: 6px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      font-size: 13px;
      transition: all 0.2s;
      cursor: default;
    }

    .osi-layer:hover { border-color: var(--accent); transform: translateX(4px); }

    .osi-layer.highlight-attack {
      border-color: var(--accent3);
      background: rgba(247,129,102,0.06);
    }

    .osi-layer.highlight-wifi {
      border-color: var(--accent);
      background: rgba(88,166,255,0.06);
    }

    .osi-num {
      font-family: var(--font-mono);
      font-size: 11px;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--border);
      color: var(--text-dim);
      flex-shrink: 0;
    }

    .osi-layer.highlight-attack .osi-num { background: rgba(247,129,102,0.3); color: var(--accent3); }
    .osi-layer.highlight-wifi .osi-num { background: rgba(88,166,255,0.2); color: var(--accent); }

    .osi-name { font-weight: 600; color: var(--text-head); width: 160px; }
    .osi-detail { color: var(--text-dim); font-size: 12px; }
    .osi-tag {
      margin-left: auto;
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 10px;
      font-weight: 600;
    }

    .tag-attack { background: rgba(247,129,102,0.2); color: var(--accent3); }
    .tag-wifi { background: rgba(88,166,255,0.15); color: var(--accent); }

    /* ── State Machine ────────────────────────────────────────── */
    .state-machine {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0;
      margin: 28px 0;
      flex-wrap: wrap;
    }

    .state-box {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: var(--radius);
      padding: 16px 20px;
      text-align: center;
      min-width: 140px;
      cursor: default;
      transition: all 0.2s;
    }

    .state-box:hover { border-color: var(--accent); }
    .state-box.state-danger:hover { border-color: var(--accent3); }

    .state-box .state-num {
      font-size: 11px;
      color: var(--text-dim);
      font-family: var(--font-mono);
      margin-bottom: 4px;
    }

    .state-box .state-name {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-head);
      margin-bottom: 6px;
    }

    .state-box .state-desc { font-size: 11px; color: var(--text-dim); line-height: 1.4; }

    .state-arrow {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0 8px;
      gap: 4px;
      font-size: 11px;
      color: var(--text-dim);
    }

    .state-arrow .arrow-label { font-size: 10px; max-width: 80px; text-align: center; }
    .state-arrow .arrow-sym { font-size: 18px; color: var(--accent); }
    .state-arrow .arrow-sym.danger { color: var(--accent3); }

    /* ── Interactive Quiz ─────────────────────────────────────── */
    .quiz-container {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 28px;
      margin: 24px 0;
    }

    .quiz-container h3 {
      font-size: 14px;
      color: var(--accent);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .quiz-question {
      margin-bottom: 28px;
    }

    .quiz-question .q-text {
      font-size: 14px;
      color: var(--text-head);
      margin-bottom: 14px;
      line-height: 1.5;
    }

    .quiz-question .q-num {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--accent);
      margin-bottom: 6px;
    }

    .option-list { display: flex; flex-direction: column; gap: 8px; }

    .option-btn {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 10px 16px;
      color: var(--text);
      text-align: left;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.15s;
      font-family: var(--font-body);
    }

    .option-btn:hover { border-color: var(--accent); color: var(--text-head); }
    .option-btn.correct { border-color: var(--accent2); background: rgba(63,185,80,0.08); color: var(--accent2); }
    .option-btn.wrong { border-color: var(--accent3); background: rgba(247,129,102,0.08); color: var(--accent3); }
    .option-btn:disabled { cursor: default; }

    .quiz-feedback {
      margin-top: 10px;
      font-size: 13px;
      padding: 10px 14px;
      border-radius: 6px;
      display: none;
      line-height: 1.5;
    }

    .quiz-feedback.show { display: block; }
    .quiz-feedback.correct-fb { background: rgba(63,185,80,0.08); border: 1px solid rgba(63,185,80,0.3); color: var(--accent2); }
    .quiz-feedback.wrong-fb { background: rgba(247,129,102,0.08); border: 1px solid rgba(247,129,102,0.3); color: var(--accent3); }

    .quiz-score {
      display: none;
      text-align: center;
      padding: 20px;
      border-top: 1px solid var(--border);
      margin-top: 20px;
    }

    .quiz-score.show { display: block; }
    .score-num { font-size: 3rem; font-weight: 700; color: var(--accent); font-family: var(--font-mono); }
    .score-label { font-size: 14px; color: var(--text-dim); margin-top: 4px; }

    /* ── Protocol Timeline ────────────────────────────────────── */
    .timeline {
      position: relative;
      padding-left: 28px;
      margin: 20px 0;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 10px;
      top: 0; bottom: 0;
      width: 2px;
      background: var(--border);
    }

    .timeline-item {
      position: relative;
      margin-bottom: 20px;
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -22px;
      top: 6px;
      width: 10px; height: 10px;
      border-radius: 50%;
      border: 2px solid var(--border);
      background: var(--bg);
    }

    .timeline-item.broken::before { border-color: var(--accent3); background: rgba(247,129,102,0.2); }
    .timeline-item.deprecated::before { border-color: var(--warn); background: rgba(210,153,34,0.2); }
    .timeline-item.ok::before { border-color: var(--accent2); background: rgba(63,185,80,0.2); }

    .timeline-year {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--text-dim);
      margin-bottom: 3px;
    }

    .timeline-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-head);
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .tl-badge {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 10px;
      font-weight: 600;
    }

    .tl-badge.broken { background: rgba(247,129,102,0.15); color: var(--accent3); }
    .tl-badge.deprecated { background: rgba(210,153,34,0.15); color: var(--warn); }
    .tl-badge.current { background: rgba(63,185,80,0.15); color: var(--accent2); }

    .timeline-desc { font-size: 12px; color: var(--text-dim); line-height: 1.5; }

    /* ── Frame diagram ────────────────────────────────────────── */
    .frame-diagram {
      display: flex;
      flex-direction: column;
      gap: 3px;
      margin: 20px 0;
      font-family: var(--font-mono);
      font-size: 12px;
    }

    .frame-field {
      display: flex;
      align-items: center;
      border-radius: 4px;
      overflow: hidden;
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.2s;
    }

    .frame-field:hover { border-color: var(--accent); }
    .frame-field.active { border-color: var(--accent); background: rgba(88,166,255,0.05); }

    .ff-name {
      background: rgba(88,166,255,0.08);
      padding: 8px 14px;
      color: var(--accent);
      font-weight: 600;
      min-width: 220px;
      border-right: 1px solid var(--border);
    }

    .ff-size {
      padding: 8px 12px;
      color: var(--text-dim);
      min-width: 100px;
      border-right: 1px solid var(--border);
    }

    .ff-desc {
      padding: 8px 16px;
      color: var(--text);
      flex: 1;
      font-family: var(--font-body);
    }

    .ff-detail {
      display: none;
      padding: 10px 14px;
      background: var(--bg);
      border-top: 1px solid var(--border);
      font-family: var(--font-body);
      font-size: 12px;
      color: var(--text-dim);
    }

    .ff-detail.show { display: block; }

    /* ── Nav footer ───────────────────────────────────────────── */
    .nav-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 32px 0 0;
      border-top: 1px solid var(--border);
      margin-top: 48px;
    }

    .nav-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      border-radius: var(--radius);
      text-decoration: none;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s;
    }

    .nav-btn.next {
      background: var(--accent);
      color: #0d1117;
    }

    .nav-btn.next:hover { background: #79c0ff; }

    .nav-btn.prev {
      border: 1px solid var(--border);
      color: var(--text-dim);
    }

    .nav-btn.prev:hover { border-color: var(--accent); color: var(--accent); }

    /* ── Callout ──────────────────────────────────────────────── */
    .callout {
      border-radius: var(--radius);
      padding: 14px 18px;
      margin: 16px 0;
      display: flex;
      gap: 12px;
      font-size: 13px;
      line-height: 1.6;
    }

    .callout.info { background: rgba(88,166,255,0.07); border-left: 3px solid var(--accent); }
    .callout.attack { background: rgba(247,129,102,0.07); border-left: 3px solid var(--accent3); }
    .callout.tip { background: rgba(63,185,80,0.07); border-left: 3px solid var(--accent2); }

    .callout .ci { flex-shrink: 0; font-size: 16px; }
    .callout strong { color: var(--text-head); }

    /* ── Scrollbar ────────────────────────────────────────────── */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }

    @media (max-width: 900px) {
      aside.sidebar { display: none; }
      main { padding: 24px 20px; }
    }
  </style>
</head>
<body>

<div class="page-wrapper">

  <!-- ── Sidebar ──────────────────────────────────────────────── -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="course-title">WiFi Exploitation Course</div>
      <h2>Wireless Security</h2>
    </div>
    <nav class="sidebar-nav">
      <div class="sidebar-section-label">Tier 1 — Foundations</div>
      <a href="#" class="active"><span class="mod-num">00</span> 802.11 Foundations</a>
      <a href="../module-01-linux-wireless-setup/"><span class="mod-num">01</span> Linux Wireless Setup</a>
      <a href="../module-02-monitor-mode/"><span class="mod-num">02</span> Monitor Mode</a>

      <div class="sidebar-section-label">Tier 2 — Recon</div>
      <a href="../module-03-reconnaissance/"><span class="mod-num">03</span> Reconnaissance</a>
      <a href="../module-04-packet-analysis/"><span class="mod-num">04</span> Packet Analysis</a>

      <div class="sidebar-section-label">Tier 3 — Legacy</div>
      <a href="../module-05-wep-cracking/"><span class="mod-num">05</span> WEP Cracking</a>

      <div class="sidebar-section-label">Tier 4 — WPA2-Personal</div>
      <a href="../module-06-wpa2-handshake/"><span class="mod-num">06</span> WPA2 Handshake</a>
      <a href="../module-07-wpa2-cracking/"><span class="mod-num">07</span> WPA2 Cracking</a>

      <div class="sidebar-section-label">Tier 5 — Active Attacks</div>
      <a href="../module-08-deauth-dos/"><span class="mod-num">08</span> Deauth &amp; DoS</a>

      <div class="sidebar-section-label">Tier 6 — Rogue AP</div>
      <a href="../module-09-evil-twin/"><span class="mod-num">09</span> Evil Twin</a>
      <a href="../module-10-captive-portal/"><span class="mod-num">10</span> Captive Portal</a>

      <div class="sidebar-section-label">Tier 7 — WPS</div>
      <a href="../module-11-wps-attacks/"><span class="mod-num">11</span> WPS Attacks</a>

      <div class="sidebar-section-label">Tier 8 — Modern</div>
      <a href="../module-12-pmkid-attack/"><span class="mod-num">12</span> PMKID Attack</a>
      <a href="../module-13-enterprise-wpa/"><span class="mod-num">13</span> WPA-Enterprise</a>

      <div class="sidebar-section-label">Tier 9 — Chaining</div>
      <a href="../module-14-attack-chaining/"><span class="mod-num">14</span> Attack Chaining</a>
    </nav>
  </aside>

  <!-- ── Main Content ──────────────────────────────────────────── -->
  <main>

    <!-- Header -->
    <div class="module-header">
      <div class="breadcrumb">
        <a href="../">WiFi Exploitation Course</a> / Module 00
      </div>
      <div class="module-badge">&#9679; Tier 1 &mdash; Foundations</div>
      <h1>Networking &amp; 802.11 Foundations</h1>
      <p class="subtitle">
        Master the protocol fundamentals that underpin every wireless attack.
        Without this knowledge, you are guessing. With it, you understand
        exactly <em>why</em> each exploit works.
      </p>
      <div class="meta-row">
        <div class="meta-pill"><span class="dot" style="background:#3fb950"></span> Beginner</div>
        <div class="meta-pill"><span class="dot" style="background:#58a6ff"></span> ~90 min read</div>
        <div class="meta-pill"><span class="dot" style="background:#d29922"></span> No tools required</div>
      </div>
    </div>

    <!-- Legal Warning -->
    <div class="warning-box">
      <span class="icon">&#9888;</span>
      <p>
        <strong>Legal Notice:</strong> This course is for <strong>authorized penetration testing and education only</strong>.
        Performing wireless attacks against networks you do not own or lack explicit written permission to test
        is illegal under the CFAA, UK Computer Misuse Act, and equivalent laws worldwide. Always work in
        an isolated lab environment.
      </p>
    </div>

    <!-- Section 1: OSI Model -->
    <section id="osi">
      <h2><span class="section-num">01</span> The OSI Model &amp; Where Wi-Fi Lives</h2>
      <p>
        The OSI model divides network communication into seven abstract layers.
        Wi-Fi operates at <strong>Layer 1 (Physical)</strong> and <strong>Layer 2 (Data Link)</strong>.
        The Data Link layer — specifically the MAC sublayer — is the primary attack surface for wireless exploitation.
      </p>

      <div class="osi-stack">
        <div class="osi-layer"><span class="osi-num">7</span><span class="osi-name">Application</span><span class="osi-detail">HTTP, DNS, FTP, SMTP</span></div>
        <div class="osi-layer"><span class="osi-num">6</span><span class="osi-name">Presentation</span><span class="osi-detail">TLS/SSL, encoding, compression</span></div>
        <div class="osi-layer"><span class="osi-num">5</span><span class="osi-name">Session</span><span class="osi-detail">Session management, RPC</span></div>
        <div class="osi-layer"><span class="osi-num">4</span><span class="osi-name">Transport</span><span class="osi-detail">TCP, UDP, port numbers</span></div>
        <div class="osi-layer"><span class="osi-num">3</span><span class="osi-name">Network</span><span class="osi-detail">IP addressing, routing</span></div>
        <div class="osi-layer highlight-attack highlight-wifi"><span class="osi-num">2</span><span class="osi-name">Data Link</span><span class="osi-detail">MAC frames, 802.11 management/control/data</span><span class="osi-tag tag-attack">PRIMARY ATTACK SURFACE</span></div>
        <div class="osi-layer highlight-wifi"><span class="osi-num">1</span><span class="osi-name">Physical</span><span class="osi-detail">RF signal, modulation (OFDM, MIMO), channels</span><span class="osi-tag tag-wifi">802.11 PHY</span></div>
      </div>

      <div class="callout attack">
        <span class="ci">&#128247;</span>
        <div><strong>Critical Insight:</strong> 802.11 management frames have <strong>no authentication and no encryption by default</strong>.
        Any station can forge a management frame impersonating any other station.
        This is the root cause of deauthentication attacks, Evil Twins, and beacon flooding — all covered in later modules.</div>
      </div>
    </section>

    <!-- Section 2: Identifiers -->
    <section id="identifiers">
      <h2><span class="section-num">02</span> Network Identifiers</h2>
      <p>Understanding the difference between these terms is essential for targeting correctly in <code>airodump-ng</code>.</p>

      <div class="card-grid">
        <div class="card">
          <div class="card-icon">&#128225;</div>
          <div class="card-title">SSID</div>
          <div class="card-desc">Service Set Identifier. The human-readable Wi-Fi name (up to 32 bytes). Example: <code>CoffeeShop_WiFi</code></div>
        </div>
        <div class="card">
          <div class="card-icon">&#128206;</div>
          <div class="card-title">BSSID</div>
          <div class="card-desc">MAC address of the AP radio. Primary targeting identifier. Example: <code>AA:BB:CC:DD:EE:FF</code>. Can be spoofed.</div>
        </div>
        <div class="card">
          <div class="card-icon">&#128269;</div>
          <div class="card-title">Hidden SSID</div>
          <div class="card-desc">AP suppresses SSID in Beacons. SSID still appears in Probe Responses and Association Requests. Security through obscurity only.</div>
        </div>
        <div class="card">
          <div class="card-icon">&#127758;</div>
          <div class="card-title">ESSID</div>
          <div class="card-desc">Extended SSID — same as SSID in modern usage. Multiple APs (BSSIDs) can share one ESSID forming an ESS (campus network).</div>
        </div>
      </div>
    </section>

    <!-- Section 3: 802.11 Standards -->
    <section id="standards">
      <h2><span class="section-num">03</span> The 802.11 Standard Family</h2>
      <p>The amendment determines available cipher suites and maximum speeds. Attack selection must match the target's capabilities.</p>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Amendment</th>
              <th>Name</th>
              <th>Frequency</th>
              <th>Max Speed</th>
              <th>Era</th>
            </tr>
          </thead>
          <tbody>
            <tr><td><code>802.11b</code></td><td>Wi-Fi 1</td><td>2.4 GHz</td><td>11 Mbps</td><td><span class="tag-broken">WEP era</span></td></tr>
            <tr><td><code>802.11a</code></td><td>Wi-Fi 2</td><td>5 GHz</td><td>54 Mbps</td><td><span class="tag-broken">WEP era</span></td></tr>
            <tr><td><code>802.11g</code></td><td>Wi-Fi 3</td><td>2.4 GHz</td><td>54 Mbps</td><td><span class="tag-warn">WEP/WPA era</span></td></tr>
            <tr><td><code>802.11n</code></td><td>Wi-Fi 4</td><td>2.4/5 GHz</td><td>600 Mbps</td><td><span class="tag-warn">WPA2 era</span></td></tr>
            <tr><td><code>802.11ac</code></td><td>Wi-Fi 5</td><td>5 GHz</td><td>3.5 Gbps</td><td><span class="tag-warn">WPA2/WPA3</span></td></tr>
            <tr><td><code>802.11ax</code></td><td>Wi-Fi 6/6E</td><td>2.4/5/6 GHz</td><td>9.6 Gbps</td><td><span class="tag-ok">WPA3 era</span></td></tr>
          </tbody>
        </table>
      </div>

      <div class="callout tip">
        <span class="ci">&#128161;</span>
        <div><strong>Tip:</strong> When scanning with <code>airodump-ng</code>, the <code>ENC</code> and <code>CIPHER</code>
        columns immediately tell you the target's protocol. <code>WEP</code> targets go to Module 05;
        <code>WPA2 CCMP</code> targets go to Modules 06–07.</div>
      </div>
    </section>

    <!-- Section 4: Frame Structure (Interactive) -->
    <section id="frames">
      <h2><span class="section-num">04</span> 802.11 Frame Architecture</h2>
      <p>Click any field below to expand its description and attack relevance.</p>

      <div class="diagram-placeholder">
        <img src="../assets/images/placeholder-80211-frame-diagram.png" alt="802.11 MAC Frame Structure Diagram" />
        <p>[ Placeholder: 802.11 MAC frame structure diagram ]</p>
      </div>

      <div class="frame-diagram" id="frameDiagram">
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">Frame Control</span>
          <span class="ff-size">2 bytes</span>
          <span class="ff-desc">Type, subtype, flags (ToDS, FromDS, Protected, Retry...)</span>
          <div class="ff-detail">Contains the frame type (Management/Control/Data), subtype (Beacon=8, Deauth=12...), and the <strong>Protected bit</strong> (bit 14). If Protected=0 on a data frame, the payload is unencrypted. The ToDS/FromDS bits determine frame direction and how the four address fields are interpreted.</div>
        </div>
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">Duration/ID</span>
          <span class="ff-size">2 bytes</span>
          <span class="ff-desc">NAV (Network Allocation Vector) — how long the medium is reserved</span>
          <div class="ff-detail">Used by CSMA/CA to prevent collisions. Other stations set their NAV timer to this value and defer transmission. In PS-Poll frames, this field carries the Association ID instead.</div>
        </div>
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">Address 1 (Receiver)</span>
          <span class="ff-size">6 bytes</span>
          <span class="ff-desc">Destination MAC — always the immediate receiver</span>
          <div class="ff-detail">The immediate recipient of the frame. In a deauth attack, this is the client's MAC address (or FF:FF:FF:FF:FF:FF for broadcast deauth targeting all clients simultaneously).</div>
        </div>
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">Address 2 (Transmitter)</span>
          <span class="ff-size">6 bytes</span>
          <span class="ff-desc">Source MAC — the immediate transmitter. <strong>Can be spoofed.</strong></span>
          <div class="ff-detail"><strong>Critical for attacks:</strong> In a deauth attack, this field is set to the BSSID of the AP being impersonated. Since 802.11 has no source authentication, the client accepts this frame as legitimate. This field is also what <code>aireplay-ng</code> spoofs during fake authentication.</div>
        </div>
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">Address 3 (BSSID)</span>
          <span class="ff-size">6 bytes</span>
          <span class="ff-desc">Filtering address — AP's BSSID in infrastructure mode</span>
          <div class="ff-detail">Used for filtering at the MAC layer. Clients only process frames where Address 3 matches their associated AP's BSSID. In IBSS (ad-hoc) mode, this is the IBSS BSSID.</div>
        </div>
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">Sequence Control</span>
          <span class="ff-size">2 bytes</span>
          <span class="ff-desc">Fragment number (4 bits) + Sequence number (12 bits)</span>
          <div class="ff-detail">Enables fragment reassembly and duplicate detection. The <code>Retry</code> bit in Frame Control is set when a frame is retransmitted. Sequence numbers also help correlate frames within the 4-way handshake.</div>
        </div>
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">Frame Body</span>
          <span class="ff-size">0–7951 bytes</span>
          <span class="ff-desc">Payload — varies by frame type</span>
          <div class="ff-detail">For Beacon frames: contains SSID, supported rates, RSN IE (cipher suite info). For Data frames: contains the LLC/SNAP header + IP packet (encrypted if Protected bit is set). For EAPOL frames: contains the 4-way handshake messages used to derive the PTK.</div>
        </div>
        <div class="frame-field" onclick="toggleField(this)">
          <span class="ff-name">FCS (Frame Check Sequence)</span>
          <span class="ff-size">4 bytes</span>
          <span class="ff-desc">CRC-32 integrity check over the entire frame</span>
          <div class="ff-detail">Detects transmission errors (bit flips). Does <em>not</em> provide authentication — a crafted frame with a valid FCS will be accepted. <code>aireplay-ng</code> recalculates the FCS after modifying frames.</div>
        </div>
      </div>
    </section>

    <!-- Section 5: Station State Machine -->
    <section id="states">
      <h2><span class="section-num">05</span> Station State Machine</h2>
      <p>
        802.11 defines three states for client-AP relationships.
        A <strong>Deauthentication frame</strong> (subtype 12) drops a client
        from any state back to State 1 — instantly.
        This is the mechanism behind all deauth attacks in Module 08.
      </p>

      <div class="state-machine">
        <div class="state-box">
          <div class="state-num">STATE 1</div>
          <div class="state-name">Unauthenticated</div>
          <div class="state-desc">Unassociated<br/>Client is aware of the AP</div>
        </div>
        <div class="state-arrow">
          <div class="arrow-label">Authenticate</div>
          <div class="arrow-sym">&#8594;</div>
          <div class="arrow-label" style="color:var(--accent3)">&#8592; Deauth</div>
        </div>
        <div class="state-box">
          <div class="state-num">STATE 2</div>
          <div class="state-name">Authenticated</div>
          <div class="state-desc">Unassociated<br/>Cannot pass data yet</div>
        </div>
        <div class="state-arrow">
          <div class="arrow-label">Associate</div>
          <div class="arrow-sym">&#8594;</div>
          <div class="arrow-label" style="color:var(--warn)">&#8592; Disassoc</div>
        </div>
        <div class="state-box state-danger">
          <div class="state-num">STATE 3</div>
          <div class="state-name">Authenticated</div>
          <div class="state-desc">Associated<br/>4-way handshake here<br/>Data flows</div>
        </div>
      </div>

      <div class="callout attack">
        <span class="ci">&#9889;</span>
        <div>
          <strong>Attack Vector:</strong> A forged Deauth frame drops the client to State 1.
          The client immediately begins re-association, performing the 4-way handshake again.
          An attacker captures this handshake for offline cracking (Module 06).
          The client has <em>no way to verify</em> the deauth frame is genuine unless
          802.11w (Management Frame Protection) is enabled.
        </div>
      </div>
    </section>

    <!-- Section 6: Security Protocol Timeline -->
    <section id="protocols">
      <h2><span class="section-num">06</span> Wireless Security Protocol Timeline</h2>

      <div class="timeline">
        <div class="timeline-item broken">
          <div class="timeline-year">1999</div>
          <div class="timeline-title">WEP — Wired Equivalent Privacy <span class="tl-badge broken">BROKEN</span></div>
          <div class="timeline-desc">RC4 stream cipher with 24-bit IV sent in plaintext. ~40,000 captured IVs sufficient for PTW statistical key recovery. Module 05.</div>
        </div>
        <div class="timeline-item deprecated">
          <div class="timeline-year">2003</div>
          <div class="timeline-title">WPA-TKIP <span class="tl-badge deprecated">DEPRECATED</span></div>
          <div class="timeline-desc">RC4 + TKIP per-packet key mixing. Michael MIC vulnerable to forgery attack. Deprecated in 802.11-2012. Treat as broken.</div>
        </div>
        <div class="timeline-item deprecated">
          <div class="timeline-year">2004</div>
          <div class="timeline-title">WPA2-CCMP (802.11i) <span class="tl-badge deprecated">VULNERABLE</span></div>
          <div class="timeline-desc">AES-CCM cipher — cryptographically sound. Weakness: PSK derived from passphrase exposed in the 4-way handshake. Modules 06–07.</div>
        </div>
        <div class="timeline-item ok">
          <div class="timeline-year">2018</div>
          <div class="timeline-title">WPA3-SAE (Dragonfly) <span class="tl-badge current">CURRENT</span></div>
          <div class="timeline-desc">Replaces PSK with Simultaneous Authentication of Equals. Forward secrecy. Partial Dragonblood side-channel attacks exist. Module 13.</div>
        </div>
        <div class="timeline-item ok">
          <div class="timeline-year">2022</div>
          <div class="timeline-title">WPA3 Release 3 <span class="tl-badge current">BEST AVAILABLE</span></div>
          <div class="timeline-desc">Mandatory PMF, 192-bit security mode for enterprise, enhanced WPA3-Personal. Hardest target in this course.</div>
        </div>
      </div>
    </section>

    <!-- Section 7: Knowledge Check Quiz -->
    <section id="quiz">
      <h2><span class="section-num">07</span> Knowledge Check</h2>
      <p>Test your understanding before moving on. All questions draw from the material above.</p>

      <div class="quiz-container">
        <h3>&#127358; Module 00 Quiz</h3>

        <!-- Q1 -->
        <div class="quiz-question" id="q1">
          <div class="q-num">Question 1 of 5</div>
          <div class="q-text">A deauthentication frame is which 802.11 frame type and subtype?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this, 'q1', false)">Data frame, subtype 0 (Data)</button>
            <button class="option-btn" onclick="answer(this, 'q1', true)">Management frame, subtype 12 (0x0C)</button>
            <button class="option-btn" onclick="answer(this, 'q1', false)">Control frame, subtype 13 (ACK)</button>
            <button class="option-btn" onclick="answer(this, 'q1', false)">Management frame, subtype 8 (Beacon)</button>
          </div>
          <div class="quiz-feedback" id="fb-q1"></div>
        </div>

        <!-- Q2 -->
        <div class="quiz-question" id="q2">
          <div class="q-num">Question 2 of 5</div>
          <div class="q-text">Which field in the 802.11 MAC header indicates that the frame body is encrypted?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this, 'q2', false)">The FCS field</button>
            <button class="option-btn" onclick="answer(this, 'q2', false)">Address 3 (BSSID)</button>
            <button class="option-btn" onclick="answer(this, 'q2', true)">The Protected bit (bit 14) in Frame Control</button>
            <button class="option-btn" onclick="answer(this, 'q2', false)">The Duration/ID field</button>
          </div>
          <div class="quiz-feedback" id="fb-q2"></div>
        </div>

        <!-- Q3 -->
        <div class="quiz-question" id="q3">
          <div class="q-num">Question 3 of 5</div>
          <div class="q-text">Why does a hidden SSID provide no real security?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this, 'q3', false)">Because the BSSID is still visible in beacon frames</button>
            <button class="option-btn" onclick="answer(this, 'q3', true)">Because the SSID is still transmitted in Probe Responses and Association Requests</button>
            <button class="option-btn" onclick="answer(this, 'q3', false)">Because WEP can decrypt the hidden SSID</button>
            <button class="option-btn" onclick="answer(this, 'q3', false)">Because airodump-ng brute-forces the SSID length</button>
          </div>
          <div class="quiz-feedback" id="fb-q3"></div>
        </div>

        <!-- Q4 -->
        <div class="quiz-question" id="q4">
          <div class="q-num">Question 4 of 5</div>
          <div class="q-text">The WPA2 PMK (Pairwise Master Key) is derived from which inputs?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this, 'q4', false)">ANonce + SNonce + AP MAC + Client MAC</button>
            <button class="option-btn" onclick="answer(this, 'q4', false)">The PTK and the session MIC key</button>
            <button class="option-btn" onclick="answer(this, 'q4', true)">The passphrase and the SSID via PBKDF2-SHA1 (4096 iterations)</button>
            <button class="option-btn" onclick="answer(this, 'q4', false)">The RC4 keystream and the IV</button>
          </div>
          <div class="quiz-feedback" id="fb-q4"></div>
        </div>

        <!-- Q5 -->
        <div class="quiz-question" id="q5">
          <div class="q-num">Question 5 of 5</div>
          <div class="q-text">Which IEEE standard introduced Management Frame Protection (MFP/PMF) to defend against forged deauthentication attacks?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this, 'q5', false)">802.11i</button>
            <button class="option-btn" onclick="answer(this, 'q5', false)">802.11n</button>
            <button class="option-btn" onclick="answer(this, 'q5', true)">802.11w</button>
            <button class="option-btn" onclick="answer(this, 'q5', false)">802.11r</button>
          </div>
          <div class="quiz-feedback" id="fb-q5"></div>
        </div>

        <!-- Score -->
        <div class="quiz-score" id="quizScore">
          <div class="score-num" id="scoreNum">0/5</div>
          <div class="score-label" id="scoreLabel"></div>
        </div>
      </div>
    </section>

    <!-- Nav Footer -->
    <div class="nav-footer">
      <span></span>
      <a href="../module-01-linux-wireless-setup/" class="nav-btn next">
        Module 01: Linux Wireless Setup &#8594;
      </a>
    </div>

  </main>
</div>

<script>
  // ── Frame field toggle ─────────────────────────────────────────
  function toggleField(el) {
    const detail = el.querySelector('.ff-detail');
    const isActive = el.classList.contains('active');
    document.querySelectorAll('.frame-field').forEach(f => {
      f.classList.remove('active');
      f.querySelector('.ff-detail').classList.remove('show');
    });
    if (!isActive) {
      el.classList.add('active');
      detail.classList.add('show');
    }
  }

  // ── Quiz logic ─────────────────────────────────────────────────
  const answers = { q1: false, q2: false, q3: false, q4: false, q5: false };
  const feedbacks = {
    q1: {
      correct: "Correct. Deauthentication (subtype 12, 0x0C) is a Management frame. Because management frames are unauthenticated by default, an attacker can forge one with the AP's BSSID as the source.",
      wrong: "Incorrect. Deauthentication is a Management frame (type=00) with subtype 1100 (decimal 12). Beacons are subtype 8; ACKs are Control frames."
    },
    q2: {
      correct: "Correct. Bit 14 of the Frame Control field is the Protected bit (also called the Privacy bit in older docs). When set, the frame body is encrypted by WEP, TKIP, or CCMP.",
      wrong: "Incorrect. The Protected/Privacy bit (bit 14) in the Frame Control field signals an encrypted frame body. FCS is only a CRC integrity check, not an encryption indicator."
    },
    q3: {
      correct: "Correct. While the SSID is removed from Beacon frames, it is still broadcast in Probe Response frames (when clients actively scan) and in Association Requests. airodump-ng captures it as soon as a client connects.",
      wrong: "Incorrect. The key issue is that the SSID is still transmitted in Probe Responses and Association Requests — captured passively by any monitor-mode adapter."
    },
    q4: {
      correct: "Correct. PMK = PBKDF2(HMAC-SHA1, passphrase, SSID, 4096 iterations, 256 bits). Both the passphrase AND the SSID are inputs, which is why rainbow tables are SSID-specific.",
      wrong: "Incorrect. The PMK is derived from the passphrase + SSID using PBKDF2-SHA1 with 4096 iterations. The nonces and MACs are used to derive the PTK from the PMK — a separate step."
    },
    q5: {
      correct: "Correct. 802.11w (2009) introduced PMF/MFP, cryptographically protecting deauth and disassoc frames. WPA3 mandates 802.11w. Note: even with PMF, some limitations exist — covered in Module 08.",
      wrong: "Incorrect. 802.11w introduced Management Frame Protection. 802.11i is WPA2/RSN, 802.11r is fast BSS transition (roaming), and 802.11n introduced MIMO/HT."
    }
  };

  let score = 0;
  let answered = 0;

  function answer(btn, qId, isCorrect) {
    if (answers[qId]) return; // already answered
    answers[qId] = true;
    answered++;

    const qEl = document.getElementById(qId);
    const buttons = qEl.querySelectorAll('.option-btn');
    buttons.forEach(b => b.disabled = true);

    const fb = document.getElementById('fb-' + qId);
    if (isCorrect) {
      btn.classList.add('correct');
      score++;
      fb.textContent = '✓ ' + feedbacks[qId].correct;
      fb.className = 'quiz-feedback correct-fb show';
    } else {
      btn.classList.add('wrong');
      fb.textContent = '✗ ' + feedbacks[qId].wrong;
      fb.className = 'quiz-feedback wrong-fb show';
      // highlight correct button
      buttons.forEach(b => {
        if (b.onclick.toString().includes('true')) b.classList.add('correct');
      });
    }

    if (answered === 5) showScore();
  }

  function showScore() {
    const scoreEl = document.getElementById('quizScore');
    const numEl = document.getElementById('scoreNum');
    const labelEl = document.getElementById('scoreLabel');
    numEl.textContent = score + '/5';
    const msgs = ['Keep studying — re-read the sections above.', 'Getting there — review the missed questions.', 'Good work! A few gaps to address.', 'Strong understanding!', 'Perfect score — ready for Module 01!'];
    labelEl.textContent = msgs[score] || msgs[4];
    numEl.style.color = score >= 4 ? 'var(--accent2)' : score >= 2 ? 'var(--warn)' : 'var(--accent3)';
    scoreEl.classList.add('show');
  }

  // ── Sidebar active link ────────────────────────────────────────
  // Already set by class in HTML for module 00
</script>

</body>
</html>
